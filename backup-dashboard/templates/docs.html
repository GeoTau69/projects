<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ“– Backup Dashboard - Dokumentace</title>
    <style>
        :root {
            --bg: #0d1117;
            --bg2: #161b22;
            --bg3: #21262d;
            --border: #30363d;
            --text: #e6edf3;
            --text2: #8b949e;
            --green: #3fb950;
            --yellow: #d29922;
            --red: #f85149;
            --blue: #58a6ff;
            --purple: #bc8cff;
            --orange: #f0883e;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.7;
        }

        /* Navigation */
        .top-bar {
            background: var(--bg2);
            border-bottom: 1px solid var(--border);
            padding: 12px 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        .top-bar-left {
            display: flex;
            gap: 20px;
            align-items: center;
        }
        .btn-back {
            background: var(--blue);
            color: white !important;
            padding: 8px 16px;
            border-radius: 6px;
            text-decoration: none;
            font-weight: 600;
            font-size: 14px;
            transition: all 0.2s;
        }
        .btn-back:hover {
            opacity: 0.9;
            transform: translateY(-1px);
        }

        /* Live Status Badge */
        .status-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            background: rgba(63, 185, 80, 0.15);
            color: var(--green);
            border: 1px solid rgba(63, 185, 80, 0.3);
        }
        .pulse {
            width: 8px;
            height: 8px;
            background: var(--green);
            border-radius: 50%;
            animation: pulse 2s ease-in-out infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }

        .layout {
            display: flex;
            max-width: 1400px;
            margin: 0 auto;
        }

        /* Sidebar TOC */
        .sidebar {
            width: 280px;
            min-width: 280px;
            padding: 24px 16px;
            border-right: 1px solid var(--border);
            position: sticky;
            top: 52px;
            height: calc(100vh - 52px);
            overflow-y: auto;
        }
        .sidebar h3 {
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--text2);
            margin: 16px 0 8px;
        }
        .sidebar a {
            display: block;
            padding: 4px 12px;
            color: var(--text);
            text-decoration: none;
            font-size: 14px;
            border-radius: 6px;
            margin: 2px 0;
        }
        .sidebar a:hover { background: var(--bg3); color: var(--blue); }

        /* Content */
        .content {
            flex: 1;
            padding: 32px 48px;
            max-width: 900px;
        }

        h1 { font-size: 32px; margin-bottom: 8px; }
        h2 {
            font-size: 22px;
            margin: 48px 0 16px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--border);
            color: var(--blue);
        }
        h3 { font-size: 17px; margin: 24px 0 8px; color: var(--text); }
        p { margin-bottom: 12px; }
        ul, ol { margin: 8px 0 16px 24px; }
        li { margin-bottom: 6px; }

        code {
            background: var(--bg3);
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'JetBrains Mono', 'Fira Code', monospace;
            font-size: 13px;
        }
        pre {
            background: var(--bg3);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 16px;
            overflow-x: auto;
            font-family: 'JetBrains Mono', 'Fira Code', monospace;
            font-size: 13px;
            line-height: 1.5;
            margin: 12px 0 20px;
        }

        .card-doc {
            background: var(--bg2);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 20px;
            margin: 16px 0;
        }
        .card-doc.warning {
            border-color: var(--yellow);
            background: #1c1500;
        }
        .card-doc.danger {
            border-color: var(--red);
            background: #1c0a0a;
        }
        .card-doc.info {
            border-color: var(--blue);
            background: #0a1929;
        }
        .card-doc.success {
            border-color: var(--green);
            background: #0a1c0a;
        }
        .card-doc .card-title {
            font-weight: 600;
            margin-bottom: 8px;
            font-size: 15px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 12px 0 20px;
            font-size: 14px;
        }
        th, td {
            padding: 10px 14px;
            border: 1px solid var(--border);
            text-align: left;
        }
        th { background: var(--bg3); font-weight: 600; }

        .badge {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
        }
        .badge-green { background: #0d2818; color: var(--green); }
        .badge-yellow { background: #2a1e00; color: var(--yellow); }
        .badge-red { background: #2d0a0a; color: var(--red); }
        .badge-blue { background: #0c2d6b; color: var(--blue); }
        .badge-purple { background: #271052; color: var(--purple); }

        .schema {
            background: var(--bg3);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 20px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 13px;
            line-height: 1.6;
            margin: 16px 0;
            overflow-x: auto;
        }

        /* Live Status Section */
        .live-status {
            background: linear-gradient(135deg, #0d1117 0%, #1a1e2e 100%);
            border: 2px solid var(--green);
            border-radius: 12px;
            padding: 24px;
            margin: 24px 0;
        }
        .live-status h3 {
            color: var(--green);
            margin: 0 0 16px 0;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
            margin-top: 12px;
        }
        .status-item {
            background: var(--bg2);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 12px;
        }
        .status-item-label {
            font-size: 11px;
            color: var(--text2);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .status-item-value {
            font-size: 18px;
            font-weight: 600;
            margin-top: 4px;
        }
        .status-item-value.ok { color: var(--green); }
        .status-item-value.warn { color: var(--yellow); }
        .status-item-value.error { color: var(--red); }

        .copy-btn {
            background: var(--purple);
            color: white;
            border: none;
            padding: 6px 14px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 600;
            margin-bottom: 12px;
        }
        .copy-btn:hover { opacity: 0.8; }

        @media (max-width: 900px) {
            .sidebar { display: none; }
            .content { padding: 24px 16px; }
        }
    
        /* Export a Print styly */
        @media print {
            * {
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }
            body {
                background: white !important;
                color: black !important;
            }
            .top-bar {
                background: white !important;
                border-bottom: 2px solid #333 !important;
                color: black !important;
                position: relative !important;
            }
            .sidebar {
                display: none !important;
            }
            .layout {
                display: block !important;
            }
            .content {
                max-width: 100% !important;
                padding: 20px !important;
            }
            .live-status {
                background: #f0f9ff !important;
                border: 2px solid #0066cc !important;
                color: black !important;
            }
            .status-item {
                background: white !important;
                border: 1px solid #333 !important;
            }
            .status-item-label, .status-item-value {
                color: black !important;
            }
            h1, h2, h3 {
                color: #0066cc !important;
                page-break-after: avoid !important;
            }
            .card-doc {
                background: #f5f5f5 !important;
                border: 1px solid #999 !important;
                color: black !important;
                page-break-inside: avoid !important;
            }
            .card-doc.warning {
                background: #fff3cd !important;
                border: 2px solid #ffc107 !important;
            }
            .card-doc.danger {
                background: #f8d7da !important;
                border: 2px solid #dc3545 !important;
            }
            .card-doc.info {
                background: #d1ecf1 !important;
                border: 2px solid #0dcaf0 !important;
            }
            .card-doc.success {
                background: #d1e7dd !important;
                border: 2px solid #198754 !important;
            }
            pre, code {
                background: #f5f5f5 !important;
                border: 1px solid #ccc !important;
                color: black !important;
            }
            table {
                border: 1px solid #333 !important;
            }
            th, td {
                border: 1px solid #333 !important;
                color: black !important;
            }
            th {
                background: #e0e0e0 !important;
            }
            
            /* Architektura diagram pro print/export */
            #architektura + div {
                background: white !important;
                border: 2px solid #333 !important;
            }
            
            /* FEDORA header */
            #architektura + div > div:first-child > div {
                background: linear-gradient(135deg, #2196F3 0%, #9C27B0 100%) !important;
                color: white !important;
            }
            
            /* Vrstva 1 - zelenÃ¡ */
            #architektura + div div[style*="linear-gradient(135deg, #0d2818"] {
                background: #e8f5e9 !important;
                border: 3px solid #4CAF50 !important;
            }
            #architektura + div div[style*="linear-gradient(135deg, #0d2818"] div[style*="background: var(--green)"] {
                background: #4CAF50 !important;
                color: white !important;
            }
            
            /* Vrstva 2 - Å¾lutÃ¡ */
            #architektura + div div[style*="linear-gradient(135deg, #2a1e00"] {
                background: #fff3e0 !important;
                border: 3px solid #FF9800 !important;
            }
            #architektura + div div[style*="linear-gradient(135deg, #2a1e00"] div[style*="background: var(--yellow)"] {
                background: #FF9800 !important;
                color: white !important;
            }
            
            /* Vrstva 3 - fialovÃ¡ */
            #architektura + div div[style*="linear-gradient(135deg, #271052"] {
                background: #f3e5f5 !important;
                border: 3px solid #9C27B0 !important;
            }
            #architektura + div div[style*="linear-gradient(135deg, #271052"] div[style*="background: var(--purple)"] {
                background: #9C27B0 !important;
                color: white !important;
            }
            
            /* Backup disk sekce */
            #architektura + div div[style*="linear-gradient(135deg, var(--bg3)"] {
                background: #e3f2fd !important;
                border: 3px solid #2196F3 !important;
            }
            #architektura + div div[style*="background: var(--blue); color: white"] {
                background: #2196F3 !important;
                color: white !important;
            }
            
            /* Dashboard sekce */
            #architektura + div > div:last-child {
                background: linear-gradient(135deg, #2196F3 0%, #1565C0 100%) !important;
            }
            
            /* Badges */
            .badge-green { background: #c8e6c9 !important; color: #2e7d32 !important; }
            .badge-yellow { background: #fff9c4 !important; color: #f57f17 !important; }
            .badge-red { background: #ffcdd2 !important; color: #c62828 !important; }
            .badge-blue { background: #bbdefb !important; color: #1565c0 !important; }
            .badge-purple { background: #e1bee7 !important; color: #6a1b9a !important; }
        }
        
        @media print {
            .btn-back {
                display: none !important;
            }
            .status-badge {
                display: none !important;
            }
        }
        @media (max-width: 768px) {
            }

    </style>
</head>
<body>

<div class="top-bar">
    <div class="top-bar-left">
        <div>ğŸ“– <strong>Backup Dashboard Dokumentace</strong> &nbsp; v1.0</div>
        <span class="status-badge">
            <span class="pulse"></span>
            Live Status
        </span>
    </div>
    <div style="display: flex; gap: 12px; align-items: center;">
        <button onclick="exportHTML()" style="padding: 8px 16px; background: var(--green); border: none; border-radius: 6px; color: white; font-weight: 600; font-size: 14px; cursor: pointer;">ğŸ’¾ Export HTML</button>
        <a href="/" class="btn-back">ğŸ  ZpÄ›t na Dashboard</a>
    </div>
</div>

<div class="layout">

<!-- Sidebar -->
<nav class="sidebar">
    <h3>RychlÃ½ pÅ™Ã­stup</h3>
    <a href="/">ğŸ  Dashboard</a>
    <a href="#live-status">ğŸ“Š Live Status</a>
    
    <h3>PÅ™ehled</h3>
    <a href="#architektura">Architektura</a>
    <a href="#vrstvy">3 vrstvy zÃ¡loh</a>
    <a href="#soubory">Soubory a cesty</a>

    <h3>PouÅ¾itÃ­</h3>
    <a href="#dashboard">Dashboard</a>
    <a href="#rucni-snapshot">RuÄnÃ­ snapshot</a>
    <a href="#rucni-borg">RuÄnÃ­ Borg backup</a>
    <a href="#full-flow">Full Flow (3-v-1)</a>
    <a href="#restore">ObnovenÃ­ dat</a>
    <a href="#rollback">Rollback systÃ©mu</a>
    <a href="#nuclear">Nuclear Delete</a>

    <h3>CLI pÅ™Ã­kazy</h3>
    <a href="#cli-snapper">Snapper</a>
    <a href="#cli-borg">Borg</a>
    <a href="#cli-sync">Btrfs Sync</a>

    <h3>ScÃ©nÃ¡Å™e obnovy</h3>
    <a href="#smazany-soubor">SmazanÃ½ soubor</a>
    <a href="#rozbity-update">RozbitÃ½ update</a>
    <a href="#mrtvy-disk">MrtvÃ½ disk</a>
    <a href="#ransomware">Ransomware</a>
    <a href="#factory-reset">Factory reset</a>

    <h3>ÃšdrÅ¾ba</h3>
    <a href="#automaticke">AutomatickÃ© Ãºlohy</a>
    <a href="#monitoring">Monitoring</a>
    <a href="#rizika">Rizika a limity</a>

</nav>

<!-- Content -->
<main class="content">

<h1>ğŸ›¡ï¸ Fedora Backup Dashboard</h1>
<p style="color: var(--text2); font-size: 16px; margin-bottom: 32px;">
    KompletnÃ­ dokumentace 3-vrstvÃ©ho zÃ¡lohovacÃ­ho systÃ©mu pro Fedora 43 Workstation
</p>

<!-- LIVE STATUS -->
<div class="live-status" id="live-status">
    <h3 style="display: flex; align-items: center; gap: 12px;">
        <span class="pulse"></span>
        Live Project Status
        <button onclick="updateLiveStatus()" style="background: var(--bg3); border: 1px solid var(--border); color: var(--text1); padding: 4px 10px; border-radius: 6px; cursor: pointer; font-size: 14px;" title="Aktualizovat status">ğŸ”„</button>
    </h3>
    <p style="color: var(--text2); margin-bottom: 16px;">
        AktuÃ¡lnÃ­ stav systÃ©mu | KliknÄ›te ğŸ”„ pro aktualizaci
    </p>
    
    <div class="status-grid">
        <div class="status-item">
            <div class="status-item-label">Dashboard</div>
            <div class="status-item-value ok" id="status-dashboard">â— Running</div>
        </div>
        <div class="status-item">
            <div class="status-item-label">Snapper Snapshoty</div>
            <div class="status-item-value" id="status-snapshots">â€”</div>
        </div>
        <div class="status-item">
            <div class="status-item-label">Borg Archivy</div>
            <div class="status-item-value" id="status-borg">â€”</div>
        </div>
        <div class="status-item">
            <div class="status-item-label">Backup Disk</div>
            <div class="status-item-value" id="status-disk">â€”</div>
        </div>
        <div class="status-item">
            <div class="status-item-label">Root Disk</div>
            <div class="status-item-value" id="status-root">â€”</div>
        </div>
        <div class="status-item">
            <div class="status-item-label">PoslednÃ­ Borg Backup</div>
            <div class="status-item-value" id="status-last-borg">â€”</div>
        </div>
        <div class="status-item">
            <div class="status-item-label">PoslednÃ­ Sync</div>
            <div class="status-item-value" id="status-last-sync">â€”</div>
        </div>
        <div class="status-item">
            <div class="status-item-label">Health Status</div>
            <div class="status-item-value" id="status-health">â€”</div>
        </div>
    </div>
    
    <div style="margin-top: 16px; font-size: 13px; color: var(--text2);">
        <strong>PoslednÃ­ update:</strong> <span id="status-timestamp">â€”</span>
    </div>
</div>

<script>
async function updateLiveStatus() {
    try {
        const response = await fetch('/api/health');
        const data = await response.json();
        
        // Snapshots
        const snapshots = document.getElementById('status-snapshots');
        if (data.snapshots && data.snapshots.count !== undefined) {
            snapshots.textContent = data.snapshots.count;
            snapshots.className = 'status-item-value ok';
        }
        
        // Borg
        const borg = document.getElementById('status-borg');
        if (data.borg && data.borg.count !== undefined) {
            borg.textContent = data.borg.count;
            borg.className = 'status-item-value ok';
        }
        
        // Backup disk
        const disk = document.getElementById('status-disk');
        if (data.backup_disk) {
            if (data.backup_disk.mounted) {
                disk.textContent = `${data.backup_disk.used_percent}% pouÅ¾ito`;
                disk.className = data.backup_disk.used_percent > 85 ? 'status-item-value warn' : 'status-item-value ok';
            } else {
                disk.textContent = 'âš  Unmounted';
                disk.className = 'status-item-value error';
            }
        }
        
        // Root disk
        const root = document.getElementById('status-root');
        if (data.root_disk) {
            root.textContent = `${data.root_disk.used_percent}% pouÅ¾ito`;
            root.className = data.root_disk.used_percent > 85 ? 'status-item-value warn' : 'status-item-value ok';
        }
        
        // Last Borg
        const lastBorg = document.getElementById('status-last-borg');
        if (data.borg && data.borg.last_backup) {
            lastBorg.textContent = data.borg.last_backup;
            lastBorg.className = 'status-item-value ok';
        }
        
        // Last Sync
        const lastSync = document.getElementById('status-last-sync');
        if (data.sync && data.sync.last_run) {
            lastSync.textContent = data.sync.last_run;
            lastSync.className = 'status-item-value ok';
        }
        
        // Health
        const health = document.getElementById('status-health');
        if (data.warnings && data.warnings.length === 0) {
            health.textContent = 'âœ“ OK';
            health.className = 'status-item-value ok';
        } else if (data.warnings) {
            health.textContent = `âš  ${data.warnings.length} varovÃ¡nÃ­`;
            health.className = 'status-item-value warn';
        }
        
        // Timestamp
        document.getElementById('status-timestamp').textContent = new Date().toLocaleString('cs-CZ');
        
    } catch (error) {
        console.error('Failed to update live status:', error);
        document.getElementById('status-dashboard').textContent = 'âš  Offline';
        document.getElementById('status-dashboard').className = 'status-item-value error';
    }
}

// NaÄtenÃ­ pÅ™i otevÅ™enÃ­ strÃ¡nky
updateLiveStatus();
</script>

<!-- ===== ARCHITEKTURA ===== -->
<h2 id="architektura">ğŸ—ƒï¸ Architektura</h2>

<div style="background: var(--bg2); border: 2px solid var(--border); border-radius: 12px; padding: 32px; margin: 24px 0;">
    
    <!-- Header -->
    <div style="text-align: center; margin-bottom: 32px;">
        <div style="display: inline-block; background: linear-gradient(135deg, var(--blue) 0%, var(--purple) 100%); padding: 12px 24px; border-radius: 8px;">
            <strong style="color: white; font-size: 18px;">FEDORA 43 WORKSTATION</strong>
        </div>
    </div>

    <!-- 3 Vrstvy -->
    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 32px;">
        
        <!-- Vrstva 1 -->
        <div style="background: linear-gradient(135deg, #0d2818 0%, #1a3d2a 100%); border: 2px solid var(--green); border-radius: 10px; padding: 20px; text-align: center;">
            <div style="background: var(--green); color: var(--bg); font-weight: bold; padding: 8px; border-radius: 6px; margin-bottom: 12px;">
                VRSTVA 1
            </div>
            <div style="font-size: 20px; margin-bottom: 8px;">ğŸ“¸</div>
            <div style="font-weight: 600; margin-bottom: 12px;">Snapper</div>
            <div style="font-size: 13px; color: var(--text2); line-height: 1.6;">
                Btrfs snapshoty<br>
                <code style="font-size: 11px;">(root /)</code>
            </div>
            <div style="margin-top: 16px; padding-top: 12px; border-top: 1px solid var(--green); font-size: 12px; color: var(--green);">
                /.snapshots/
            </div>
        </div>

        <!-- Vrstva 2 -->
        <div style="background: linear-gradient(135deg, #2a1e00 0%, #3d2f00 100%); border: 2px solid var(--yellow); border-radius: 10px; padding: 20px; text-align: center;">
            <div style="background: var(--yellow); color: var(--bg); font-weight: bold; padding: 8px; border-radius: 6px; margin-bottom: 12px;">
                VRSTVA 2
            </div>
            <div style="font-size: 20px; margin-bottom: 8px;">ğŸ”„</div>
            <div style="font-weight: 600; margin-bottom: 12px;">Btrfs Sync</div>
            <div style="font-size: 13px; color: var(--text2); line-height: 1.6;">
                send/receive<br>
                <code style="font-size: 11px;">inkrementÃ¡lnÃ­</code>
            </div>
            <div style="margin-top: 16px; padding-top: 12px; border-top: 1px solid var(--yellow); font-size: 12px; color: var(--yellow);">
                /system-snapshots/
            </div>
        </div>

        <!-- Vrstva 3 -->
        <div style="background: linear-gradient(135deg, #271052 0%, #3a1a6b 100%); border: 2px solid var(--purple); border-radius: 10px; padding: 20px; text-align: center;">
            <div style="background: var(--purple); color: var(--bg); font-weight: bold; padding: 8px; border-radius: 6px; margin-bottom: 12px;">
                VRSTVA 3
            </div>
            <div style="font-size: 20px; margin-bottom: 8px;">ğŸ”</div>
            <div style="font-weight: 600; margin-bottom: 12px;">Borg Backup</div>
            <div style="font-size: 13px; color: var(--text2); line-height: 1.6;">
                Å¡ifrovanÃ½, dedup<br>
                <code style="font-size: 11px;">(/home/geo)</code>
            </div>
            <div style="margin-top: 16px; padding-top: 12px; border-top: 1px solid var(--purple); font-size: 12px; color: var(--purple);">
                /borg-repo/
            </div>
        </div>
    </div>

    <!-- Arrow down -->
    <div style="text-align: center; margin: 20px 0; color: var(--text2); font-size: 24px;">
        â†“
    </div>

    <!-- Backup Disk -->
    <div style="background: linear-gradient(135deg, var(--bg3) 0%, var(--bg2) 100%); border: 2px solid var(--blue); border-radius: 10px; padding: 24px; text-align: center;">
        <div style="display: inline-flex; align-items: center; gap: 12px; background: var(--blue); color: white; padding: 10px 20px; border-radius: 8px; margin-bottom: 12px;">
            <span style="font-size: 24px;">ğŸ’¾</span>
            <div style="text-align: left;">
                <div style="font-weight: 600; font-size: 16px;">/mnt/fedora-backups</div>
                <div style="font-size: 12px; opacity: 0.9;">nvme0n1p1 â€¢ 350GB</div>
            </div>
        </div>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-top: 16px; font-size: 13px;">
            <div style="background: var(--bg); padding: 12px; border-radius: 6px; border: 1px solid var(--border);">
                <div style="color: var(--yellow); font-weight: 600; margin-bottom: 4px;">ğŸ“ system-snapshots/</div>
                <div style="color: var(--text2); font-size: 12px;">Btrfs snapshoty</div>
            </div>
            <div style="background: var(--bg); padding: 12px; border-radius: 6px; border: 1px solid var(--border);">
                <div style="color: var(--purple); font-weight: 600; margin-bottom: 4px;">ğŸ“ borg-repo/</div>
                <div style="color: var(--text2); font-size: 12px;">Borg archivy</div>
            </div>
        </div>
    </div>

    <!-- Arrow down -->
    <div style="text-align: center; margin: 20px 0; color: var(--text2); font-size: 24px;">
        â†“
    </div>

    <!-- Dashboard -->
    <div style="background: linear-gradient(135deg, var(--blue) 0%, #0066cc 100%); border-radius: 10px; padding: 20px; text-align: center;">
        <div style="display: inline-flex; align-items: center; gap: 12px; color: white;">
            <span style="font-size: 28px;">ğŸŒ</span>
            <div style="text-align: left;">
                <div style="font-weight: 700; font-size: 18px;">Backup Dashboard</div>
                <div style="font-size: 13px; opacity: 0.9;">FastAPI + Jinja2 | port 8090</div>
                <div style="font-size: 12px; opacity: 0.8; margin-top: 4px;">OvlÃ¡dÃ¡ vÅ¡echny 3 vrstvy</div>
            </div>
        </div>
    </div>

</div>

<table>
    <thead>
        <tr>
            <th>Komponenta</th>
            <th>Technologie</th>
            <th>Co zÃ¡lohuje</th>
            <th>Kam</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><span class="badge badge-green">Vrstva 1</span> Snapper</td>
            <td>Btrfs snapshoty</td>
            <td>CelÃ½ root filesystem <code>/</code></td>
            <td><code>/.snapshots/</code> (lokÃ¡lnÃ­)</td>
        </tr>
        <tr>
            <td><span class="badge badge-yellow">Vrstva 2</span> Btrfs Sync</td>
            <td>btrfs send/receive</td>
            <td>Kopie snapshotÅ¯</td>
            <td><code>/mnt/fedora-backups/system-snapshots/</code></td>
        </tr>
        <tr>
            <td><span class="badge badge-purple">Vrstva 3</span> Borg</td>
            <td>Borg Backup (Å¡ifrovanÃ½)</td>
            <td><code>/home/geo/</code></td>
            <td><code>/mnt/fedora-backups/borg-repo/</code></td>
        </tr>
    </tbody>
</table>


<!-- ===== VRSTVY ===== -->
<h2 id="vrstvy">ğŸ“š 3 vrstvy zÃ¡loh</h2>

<h3>Vrstva 1: Snapper (Btrfs snapshoty)</h3>
<div class="card-doc info">
    <div class="card-title">ğŸ“¸ LokÃ¡lnÃ­ snapshoty celÃ©ho systÃ©mu</div>
    <ul>
        <li><strong>Co:</strong> AtomickÃ½ snapshot Btrfs subvolumu <code>/</code></li>
        <li><strong>Kdy automaticky:</strong> KaÅ¾dou hodinu (timeline), pÅ™ed/po DNF operacÃ­ch</li>
        <li><strong>Retence:</strong> 5 hodinovÃ½ch, 7 dennÃ­ch, 4 tÃ½dennÃ­ch, 6 mÄ›sÃ­ÄnÃ­ch, 2 roÄnÃ­ch</li>
        <li><strong>Rychlost:</strong> OkamÅ¾itÃ½ (< 1 sekunda)</li>
        <li><strong>Rollback:</strong> <code>snapper rollback ÄŒÃSLO</code> + reboot</li>
        <li><strong>GOLDEN snapshot:</strong> ReferenÄnÃ­ ÄistÃ½ stav systÃ©mu, chrÃ¡nÄ›nÃ½ pÅ™ed smazÃ¡nÃ­m</li>
    </ul>
</div>

<h3>Vrstva 2: Btrfs Send/Receive</h3>
<div class="card-doc info">
    <div class="card-title">ğŸ”„ Sync snapshotÅ¯ na zÃ¡loÅ¾nÃ­ disk</div>
    <ul>
        <li><strong>Co:</strong> Kopie snapshotÅ¯ z <code>/.snapshots/</code> na <code>/mnt/fedora-backups/</code></li>
        <li><strong>Kdy:</strong> DennÄ› ve 03:32 (systemd timer)</li>
        <li><strong>ÃšÄel:</strong> ZÃ¡chrana pÅ™i selhÃ¡nÃ­ systÃ©movÃ©ho disku</li>
        <li><strong>Typ:</strong> InkrementÃ¡lnÃ­ (pouze zmÄ›ny)</li>
    </ul>
</div>

<h3>Vrstva 3: Borg Backup</h3>
<div class="card-doc info">
    <div class="card-title">ğŸ” Å ifrovanÃ© zÃ¡lohy /home</div>
    <ul>
        <li><strong>Co:</strong> CelÃ½ <code>/home/geo/</code> (s excludes)</li>
        <li><strong>Kdy:</strong> DennÄ› ve 03:13 (systemd timer)</li>
        <li><strong>Å ifrovÃ¡nÃ­:</strong> Ano (passphrase v <code>~/.borg-passphrase</code>)</li>
        <li><strong>Deduplikace:</strong> Ano (identickÃ© bloky se uklÃ¡dajÃ­ jen jednou)</li>
        <li><strong>Komprese:</strong> zstd</li>
        <li><strong>Browse:</strong> MoÅ¾nost prochÃ¡zet soubory v archivu a obnovit jednotlivÃ© soubory</li>
    </ul>
</div>

<!-- ===== SOUBORY ===== -->
<h2 id="soubory">ğŸ“ Soubory a cesty</h2>

<table>
    <thead>
        <tr><th>Cesta</th><th>Popis</th></tr>
    </thead>
    <tbody>
        <tr><td><code>/opt/backup-dashboard/app.py</code></td><td>HlavnÃ­ aplikace dashboardu</td></tr>
        <tr><td><code>/opt/backup-dashboard/templates/</code></td><td>HTML Å¡ablony</td></tr>
        <tr><td><code>/opt/backup-dashboard/logs/dashboard.log</code></td><td>Log dashboardu</td></tr>
        <tr><td><code>/etc/systemd/system/backup-dashboard.service</code></td><td>Systemd service</td></tr>
        <tr><td><code>/.snapshots/</code></td><td>Snapper snapshoty (lokÃ¡lnÃ­)</td></tr>
        <tr><td><code>/mnt/fedora-backups/borg-repo/</code></td><td>Borg repository</td></tr>
        <tr><td><code>/mnt/fedora-backups/system-snapshots/</code></td><td>Sync snapshoty</td></tr>
        <tr><td><code>/home/geo/.borg-passphrase</code></td><td>Borg heslo</td></tr>
        <tr><td><code>/home/geo/borg-key-backup.txt</code></td><td>ExportovanÃ½ Borg klÃ­Ä</td></tr>
    </tbody>
</table>

<!-- ===== DASHBOARD ===== -->
<h2 id="dashboard">ğŸ–¥ï¸ Dashboard</h2>
<p>Dashboard je dostupnÃ½ na:</p>
<ul>
    <li>LokÃ¡lnÄ›: <code>http://localhost:8090/</code></li>
    <li>Ze sÃ­tÄ›: <code>http://192.168.0.101:8090/</code></li>
    <li>PÅ™es Tailscale: <code>http://[tailscale-ip]:8090/</code></li>
</ul>

<h3>Sekce dashboardu</h3>
<table>
    <thead><tr><th>Sekce</th><th>Funkce</th></tr></thead>
    <tbody>
        <tr><td>ğŸ’¾ Disky</td><td>Stav root a backup disku, vyuÅ¾itÃ­ mÃ­sta</td></tr>
        <tr><td>â° AutomatickÃ© Ãºlohy</td><td>Stav systemd timerÅ¯, pÅ™Ã­Å¡tÃ­/poslednÃ­ spuÅ¡tÄ›nÃ­</td></tr>
        <tr><td>ğŸ“¸ Snapper Snapshoty</td><td>Seznam, vytvoÅ™enÃ­, smazÃ¡nÃ­, diff, rollback</td></tr>
        <tr><td>ğŸ” Borg Archivy</td><td>Seznam, vytvoÅ™enÃ­, browse, restore, smazÃ¡nÃ­</td></tr>
        <tr><td>ğŸ”„ Btrfs Sync</td><td>Sync snapshotÅ¯ na backup disk</td></tr>
        <tr><td>ğŸš€ Full Flow</td><td>KompletnÃ­ zÃ¡loha (snapshot + borg + sync)</td></tr>
        <tr><td>â˜¢ï¸ Nuclear Delete</td><td>SmazÃ¡nÃ­ vÅ¡ech zÃ¡loh (chrÃ¡nÄ›no heslem)</td></tr>
        <tr><td>ğŸ“‹ Log</td><td>Historie akcÃ­, export, smazÃ¡nÃ­</td></tr>
    </tbody>
</table>

<!-- ===== RUÄŒNÃ SNAPSHOT ===== -->
<h2 id="rucni-snapshot">ğŸ“¸ RuÄnÃ­ snapshot</h2>
<ol>
    <li>OtevÅ™i dashboard</li>
    <li>V sekci <strong>Snapper Snapshoty</strong> zadej popis (napÅ™. "PÅ™ed instalacÃ­ NVIDIA")</li>
    <li>Klikni <strong>+ Snapshot</strong></li>
    <li>Snapshot se vytvoÅ™Ã­ okamÅ¾itÄ› (< 1 s)</li>
</ol>
<div class="card-doc success">
    <div class="card-title">ğŸ’¡ Tip</div>
    VÅ¾dy dÄ›lej snapshot PÅ˜ED rizikovÃ½mi operacemi: aktualizace kernelu, instalace ovladaÄÅ¯, zmÄ›ny konfigurace.
</div>

<!-- ===== RUÄŒNÃ BORG ===== -->
<h2 id="rucni-borg">ğŸ” RuÄnÃ­ Borg backup</h2>
<ol>
    <li>V sekci <strong>Borg Archivy</strong> zadej komentÃ¡Å™</li>
    <li>Klikni <strong>+ Backup</strong></li>
    <li>Backup trvÃ¡ podle velikosti dat (typicky 1-5 minut)</li>
    <li>NÃ¡zev archivu: <code>[komentÃ¡Å™-slug]-[YYYYMMDD-HHMMSS]</code></li>
</ol>

<!-- ===== FULL FLOW ===== -->
<h2 id="full-flow">ğŸš€ Full Flow (3-v-1)</h2>
<p>Provede kompletnÃ­ zÃ¡lohu ve 3 krocÃ­ch:</p>
<ol>
    <li><span class="badge badge-blue">Krok 1</span> VytvoÅ™Ã­ Snapper snapshot (popis s prefixem [FULL])</li>
    <li><span class="badge badge-purple">Krok 2</span> SpustÃ­ Borg backup celÃ©ho /home</li>
    <li><span class="badge badge-yellow">Krok 3</span> Sync snapshotÅ¯ na backup disk</li>
</ol>
<div class="card-doc warning">
    <div class="card-title">â±ï¸ ÄŒas</div>
    Full Flow trvÃ¡ typicky 2-10 minut. StrÃ¡nka se po dokonÄenÃ­ automaticky refreshne.
</div>

<!-- ===== RESTORE ===== -->
<h2 id="restore">â™»ï¸ ObnovenÃ­ dat</h2>

<h3>Ze Snapper snapshotu (systÃ©movÃ© soubory)</h3>
<pre>
# Najdi snapshot
sudo snapper -c root list

# ProchÃ¡zej soubory
ls /.snapshots/ÄŒÃSLO/snapshot/cesta/k/souboru

# KopÃ­ruj zpÄ›t
sudo cp /.snapshots/ÄŒÃSLO/snapshot/etc/config.conf /etc/config.conf
</pre>

<h3>Z Borg archivu (home soubory)</h3>
<p>V dashboardu:</p>
<ol>
    <li>Klikni â™»ï¸ u archivu</li>
    <li>ProchÃ¡zej adresÃ¡Å™ovou strukturu (klik na ğŸ“ sloÅ¾ky)</li>
    <li>Vyber soubor/sloÅ¾ku kliknutÃ­m na â˜‘ï¸</li>
    <li>Zvol reÅ¾im: <strong>Do cÃ­lovÃ© sloÅ¾ky</strong> (bezpeÄnÃ©) nebo <strong>Na pÅ¯vodnÃ­ mÃ­sto</strong> (pÅ™epÃ­Å¡e)</li>
    <li>Klikni <strong>Obnovit</strong></li>
</ol>

<h3>Z CLI:</h3>
<pre>
export BORG_PASSCOMMAND="cat ~/.borg-passphrase"

# Seznam archivÅ¯
borg list /mnt/fedora-backups/borg-repo

# Obnovit jeden soubor
cd /tmp
borg extract /mnt/fedora-backups/borg-repo::ARCHIV home/geo/cesta/soubor

# Obnovit vÅ¡e
cd /
borg extract /mnt/fedora-backups/borg-repo::ARCHIV
</pre>

<!-- ===== ROLLBACK ===== -->
<h2 id="rollback">âª Rollback systÃ©mu</h2>

<div class="card-doc danger">
    <div class="card-title">âš ï¸ Rollback vrÃ¡tÃ­ CELÃ systÃ©m do stavu snapshotu</div>
    <p>VÅ¡echny zmÄ›ny po snapshotu budou ztraceny. /home zÅ¯stane nedotÄen (je na zvlÃ¡Å¡tnÃ­m subvolumu jen pokud je separÃ¡tnÃ­).</p>
</div>

<h3>Z dashboardu:</h3>
<ol>
    <li>Klikni âª u snapshotu</li>
    <li>PotvrÄ 2Ã— bezpeÄnostnÃ­ dialog</li>
    <li><strong>RESTARTUJ systÃ©m</strong> (rollback se dokonÄÃ­ aÅ¾ po rebootu)</li>
</ol>

<h3>Z CLI:</h3>
<pre>
sudo snapper -c root rollback ÄŒÃSLO
sudo reboot
</pre>

<h3>Z GRUBu (systÃ©m nebootuje):</h3>
<ol>
    <li>PÅ™i startu vyber <strong>Fedora Snapshots</strong> v GRUB menu</li>
    <li>Vyber poÅ¾adovanÃ½ snapshot</li>
    <li>Po nabootovÃ¡nÃ­: <code>sudo snapper -c root rollback ÄŒÃSLO && sudo reboot</code></li>
</ol>

<!-- ===== NUCLEAR ===== -->
<h2 id="nuclear">â˜¢ï¸ Nuclear Delete</h2>
<div class="card-doc danger">
    <div class="card-title">NEVRATNÃ‰ smazÃ¡nÃ­ vÅ¡ech zÃ¡loh</div>
    <p>SmaÅ¾e:</p>
    <ul>
        <li>VÅ¡echny Snapper snapshoty (kromÄ› #0 current a GOLDEN)</li>
        <li>VÅ¡echny Borg archivy</li>
        <li>VÅ¡echny sync snapshoty z backup disku</li>
    </ul>
    <p>ChrÃ¡nÄ›no: heslem + potvrzovacÃ­m textem <code>SMAZAT VSE</code> + 2Ã— confirm dialog</p>
</div>

<!-- ===== CLI ===== -->
<h2 id="cli-snapper">âŒ¨ï¸ CLI: Snapper</h2>
<pre>
# Seznam snapshotÅ¯
sudo snapper -c root list

# VytvoÅ™it snapshot
sudo snapper -c root create --description "Popis" --print-number

# Diff mezi snapshoty
sudo snapper -c root status ÄŒÃSLO1..ÄŒÃSLO2

# Rollback
sudo snapper -c root rollback ÄŒÃSLO
sudo reboot

# Smazat snapshot
sudo snapper -c root delete ÄŒÃSLO

# Konfigurace
sudo snapper -c root get-config
</pre>

<h2 id="cli-borg">âŒ¨ï¸ CLI: Borg</h2>
<pre>
export BORG_PASSCOMMAND="cat ~/.borg-passphrase"

# Seznam archivÅ¯
borg list /mnt/fedora-backups/borg-repo

# Info o repu
borg info /mnt/fedora-backups/borg-repo

# VytvoÅ™it backup
borg create --compression zstd --one-file-system \
  /mnt/fedora-backups/borg-repo::nazev-$(date +%Y%m%d-%H%M%S) \
  /home/geo \
  --exclude '*.cache*' --exclude 'thinclient_drives'

# ProchÃ¡zet archiv
borg list /mnt/fedora-backups/borg-repo::ARCHIV

# Obnovit
cd /tmp && borg extract /mnt/fedora-backups/borg-repo::ARCHIV

# Mountnout jako FS
borg mount /mnt/fedora-backups/borg-repo::ARCHIV /mnt/borg-mount

# Kontrola integrity
borg check /mnt/fedora-backups/borg-repo

# Compact (uvolnit mÃ­sto po smazÃ¡nÃ­)
borg compact /mnt/fedora-backups/borg-repo
</pre>

<h2 id="cli-sync">âŒ¨ï¸ CLI: Btrfs Sync</h2>
<pre>
# RuÄnÃ­ spuÅ¡tÄ›nÃ­
sudo systemctl start snapshot-sync.service

# Log
sudo cat /var/log/backup-snapshot-sync.log

# Stav timeru
systemctl status snapshot-sync.timer
</pre>

<!-- ===== SCÃ‰NÃÅ˜E ===== -->
<h2 id="smazany-soubor">ğŸ”¥ ScÃ©nÃ¡Å™: SmazanÃ½ soubor</h2>
<div class="card-doc">
    <div class="card-title">SystÃ©movÃ½ soubor (konfigurace, binÃ¡rka)</div>
    <pre>sudo ls /.snapshots/ÄŒÃSLO/snapshot/cesta/
sudo cp /.snapshots/ÄŒÃSLO/snapshot/etc/soubor /etc/soubor</pre>
</div>
<div class="card-doc">
    <div class="card-title">Home soubor</div>
    <pre>export BORG_PASSCOMMAND="cat ~/.borg-passphrase"
cd /tmp
borg extract /mnt/fedora-backups/borg-repo::ARCHIV home/geo/soubor</pre>
    <p>Nebo pÅ™es Dashboard â†’ Borg â†’ â™»ï¸ Restore</p>
</div>

<h2 id="rozbity-update">ğŸ”¥ ScÃ©nÃ¡Å™: RozbitÃ½ update</h2>
<div class="card-doc">
    <div class="card-title">SystÃ©m bootuje</div>
    <pre>sudo snapper -c root list          # najÃ­t pre-dnf snapshot
sudo snapper -c root rollback ÄŒÃSLO
sudo reboot</pre>
</div>
<div class="card-doc">
    <div class="card-title">SystÃ©m NEBOOTUJE</div>
    <ol>
        <li>GRUB â†’ <strong>Fedora Snapshots</strong> â†’ vyber snapshot â†’ boot</li>
        <li><code>sudo snapper -c root rollback ÄŒÃSLO && sudo reboot</code></li>
    </ol>
</div>

<h2 id="mrtvy-disk">ğŸ”¥ ScÃ©nÃ¡Å™: MrtvÃ½ systÃ©movÃ½ disk</h2>
<div class="card-doc danger">
    <div class="card-title">KompletnÃ­ obnova z backup disku</div>
    <pre>
# 1. Boot z Live USB
# 2. PÅ™iprav novÃ½ disk
mkfs.btrfs -L fedora /dev/NEW_DISK
mount /dev/NEW_DISK /mnt/new
mount /dev/nvme0n1p1 /mnt/backup

# 3. Obnov systÃ©m
ls /mnt/backup/system-snapshots/
btrfs send /mnt/backup/system-snapshots/SNAPSHOT | btrfs receive /mnt/new/
mv /mnt/new/SNAPSHOT /mnt/new/root
btrfs subvolume set-default /mnt/new/root

# 4. Reinstall GRUB + oprav fstab
# 5. Reboot

# 6. Obnov /home
export BORG_PASSCOMMAND="cat /cesta/k/passphrase"
cd / && borg extract /mnt/backup/borg-repo::ARCHIV</pre>
</div>

<h2 id="ransomware">ğŸ”¥ ScÃ©nÃ¡Å™: Ransomware</h2>
<div class="card-doc">
    <pre>
# 1. ODPOJ poÄÃ­taÄ od sÃ­tÄ›
# 2. Boot z Live USB

# 3. Obnov systÃ©m ze snapshotu pÅ™ed Ãºtokem
sudo snapper -c root rollback ÄŒÃSLO

# 4. Obnov home z Borg archivu pÅ™ed Ãºtokem
export BORG_PASSCOMMAND="cat ~/.borg-passphrase"
borg list /mnt/fedora-backups/borg-repo        # najdi archiv PÅ˜ED Ãºtokem
cd / && borg extract /mnt/fedora-backups/borg-repo::ARCHIV</pre>
</div>

<h2 id="factory-reset">ğŸ”¥ ScÃ©nÃ¡Å™: Factory reset</h2>
<div class="card-doc success">
    <div class="card-title">NÃ¡vrat na GOLDEN snapshot</div>
    <pre>sudo snapper -c root list     # najdi GOLDEN snapshot
sudo snapper -c root rollback ÄŒÃSLO_GOLDEN
sudo reboot</pre>
    <p>Nebo pÅ™es Dashboard â†’ klikni âª u GOLDEN snapshotu</p>
</div>

<!-- ===== AUTOMATICKÃ‰ ÃšLOHY ===== -->
<h2 id="automaticke">â° AutomatickÃ© Ãºlohy</h2>
<table>
    <thead><tr><th>Timer</th><th>Kdy</th><th>Co dÄ›lÃ¡</th></tr></thead>
    <tbody>
        <tr><td><code>snapper-timeline.timer</code></td><td>KaÅ¾dou hodinu</td><td>VytvoÅ™Ã­ timeline snapshot</td></tr>
        <tr><td><code>snapper-cleanup.timer</code></td><td>KaÅ¾dou hodinu</td><td>SmaÅ¾e starÃ© snapshoty dle retence</td></tr>
        <tr><td><code>borg-backup.timer</code></td><td>DennÄ› ~03:13</td><td>Borg backup /home/geo</td></tr>
        <tr><td><code>snapshot-sync.timer</code></td><td>DennÄ› ~03:32</td><td>Btrfs send/receive na backup disk</td></tr>
    </tbody>
</table>
<pre>
# OvÄ›Å™enÃ­ stavu timerÅ¯
systemctl list-timers | grep -iE "borg|snapshot|snapper"
</pre>

<!-- ===== MONITORING ===== -->
<h2 id="monitoring">ğŸ“Š Monitoring</h2>
<pre>
# ZdravÃ­ systÃ©mu
curl -s http://localhost:8090/api/health | python3 -m json.tool

# MÃ­sto na discÃ­ch
df -h / /mnt/fedora-backups

# Je backup disk mounted?
mountpoint /mnt/fedora-backups

# PoslednÃ­ borg backup
export BORG_PASSCOMMAND="cat ~/.borg-passphrase"
borg list /mnt/fedora-backups/borg-repo --last 1

# Dashboard log
tail -20 /opt/backup-dashboard/logs/dashboard.log

# Systemd logy
sudo journalctl -u borg-backup.service --since today
sudo journalctl -u snapshot-sync.service --since today
sudo journalctl -u backup-dashboard.service -n 20
</pre>

<!-- ===== RIZIKA ===== -->
<h2 id="rizika">âš ï¸ Rizika a limity</h2>

<div class="card-doc danger">
    <div class="card-title">ğŸ”‘ Borg klÃ­Ä a heslo</div>
    <p>Bez <code>~/.borg-passphrase</code> a <code>~/borg-key-backup.txt</code> jsou Borg zÃ¡lohy <strong>NEÄŒITELNÃ‰</strong>.</p>
    <p>UloÅ¾ kopie mimo tento poÄÃ­taÄ: USB disk, cloud, tisk na papÃ­r.</p>
</div>

<div class="card-doc warning">
    <div class="card-title">ğŸŒ Å½Ã¡dnÃ½ offsite backup</div>
    <p>ObÄ› zÃ¡lohy (Snapper i Borg) jsou na stejnÃ©m PC. KrÃ¡deÅ¾, poÅ¾Ã¡r nebo pÅ™epÄ›tÃ­ = ztrÃ¡ta vÅ¡eho.</p>
    <p>ZvaÅ¾: BorgBase, rsync.net, druhÃ½ PC, NAS.</p>
</div>

<div class="card-doc warning">
    <div class="card-title">ğŸ’¾ Backup disk musÃ­ bÃ½t mounted</div>
    <p>Pokud <code>/mnt/fedora-backups</code> nenÃ­ pÅ™ipojen, Borg i Sync zÃ¡lohy <strong>selÅ¾ou tiÅ¡e</strong>.</p>
    <p>Dashboard zobrazuje varovÃ¡nÃ­, ale automatickÃ© Ãºlohy mohou selhat.</p>
</div>

<div class="card-doc info">
    <div class="card-title">ğŸ“ Limity</div>
    <ul>
        <li>Snapper snapshoty zabÃ­rajÃ­ mÃ­sto na root disku ÃºmÄ›rnÄ› zmÄ›nÃ¡m</li>
        <li>Borg deduplikace Å¡etÅ™Ã­ mÃ­sto, ale repo roste s Äasem</li>
        <li>Dashboard bÄ›Å¾Ã­ jako root (nutnÃ© pro snapper/btrfs operace)</li>
        <li>Restore z dashboardu zatÃ­m v development fÃ¡zi</li>
    </ul>
</div>

</main>

</div>

<script>
function exportHTML() {
    let exportContent = document.documentElement.cloneNode(true);
    let exportBar = exportContent.querySelector('.btn-export-html');
    if (exportBar) exportBar.remove();
    let backBtn = exportContent.querySelector('.btn-back');
    if (backBtn) backBtn.remove();

    const content = '<!DOCTYPE html>\n' + exportContent.outerHTML;
    const blob = new Blob([content], { type: 'text/html;charset=utf-8' });
    const link = document.createElement('a');
    link.href = URL.createObjectURL(blob);
    const date = new Date().toISOString().split('T')[0];
    link.download = `fedora-backup-dokumentace-${date}.html`;
    link.click();
    showToast('HTML dokument staÅ¾en');
}

function showToast(message) {
    const toast = document.createElement('div');
    toast.style.cssText = `
        position: fixed;
        bottom: 24px;
        right: 24px;
        background: var(--green);
        color: white;
        padding: 16px 24px;
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        z-index: 10000;
        font-weight: 600;
        animation: slideIn 0.3s ease-out;
    `;
    toast.textContent = message;
    document.body.appendChild(toast);
    setTimeout(() => {
        toast.style.animation = 'slideOut 0.3s ease-out';
        setTimeout(() => toast.remove(), 300);
    }, 3000);
}

const style = document.createElement('style');
style.textContent = `
    @keyframes slideIn {
        from { transform: translateX(400px); opacity: 0; }
        to { transform: translateX(0); opacity: 1; }
    }
    @keyframes slideOut {
        from { transform: translateX(0); opacity: 1; }
        to { transform: translateX(400px); opacity: 0; }
    }
    @media print {
        .top-bar, .sidebar, .status-badge { display: none !important; }
        .content { max-width: 100% !important; padding: 20px !important; }
        .layout { display: block !important; }
        body { background: white !important; color: black !important; }
        h1, h2, h3 { color: #000 !important; }
        .card-doc, .schema, pre { border: 1px solid #ccc !important; background: #f5f5f5 !important; }
    }
`;
document.head.appendChild(style);
</script>

</body>
</html>
