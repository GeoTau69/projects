<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ“– Fedora Backup Dashboard â€” Dokumentace</title>
<style>
:root {
    --bg: #0d1117;
    --bg2: #161b22;
    --bg3: #21262d;
    --border: #30363d;
    --text: #e6edf3;
    --text2: #8b949e;
    --green: #3fb950;
    --yellow: #d29922;
    --red: #f85149;
    --blue: #58a6ff;
    --purple: #bc8cff;
    --orange: #f0883e;
}
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: 'Segoe UI', system-ui, sans-serif;
    background: var(--bg);
    color: var(--text);
    line-height: 1.7;
}

/* â”€â”€ Top bar â”€â”€ */
.top-bar {
    background: var(--bg2);
    border-bottom: 1px solid var(--border);
    padding: 12px 24px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    position: sticky;
    top: 0;
    z-index: 100;
}
.top-bar-title { font-size: 15px; font-weight: 600; }
.top-bar-meta  { font-size: 12px; color: var(--text2); display: flex; align-items: center; gap: 10px; }

/* â”€â”€ Layout â”€â”€ */
.layout {
    display: flex;
    max-width: 1400px;
    margin: 0 auto;
}

/* â”€â”€ Sidebar â”€â”€ */
.sidebar {
    width: 260px;
    min-width: 260px;
    padding: 20px 16px;
    border-right: 1px solid var(--border);
    position: sticky;
    top: 52px;
    height: calc(100vh - 52px);
    overflow-y: auto;
}
.sidebar h3 {
    font-size: 11px;
    text-transform: uppercase;
    letter-spacing: 1px;
    color: var(--text2);
    margin: 16px 0 6px;
    padding: 0 12px;
}
.sidebar a {
    display: block;
    padding: 5px 12px;
    color: var(--text);
    text-decoration: none;
    font-size: 13px;
    border-radius: 6px;
    margin: 1px 0;
    transition: background 0.1s;
}
.sidebar a:hover { background: var(--bg3); color: var(--blue); }
.sidebar a.active { background: var(--bg3); color: var(--blue); }

/* â”€â”€ HlavnÃ­ obsah â”€â”€ */
.content {
    flex: 1;
    padding: 32px 48px;
    max-width: 900px;
}
h1 { font-size: 30px; margin-bottom: 6px; }
h2 {
    font-size: 21px;
    margin: 48px 0 16px;
    padding-bottom: 8px;
    border-bottom: 1px solid var(--border);
    color: var(--blue);
    scroll-margin-top: 64px;
}
h3 { font-size: 16px; margin: 24px 0 8px; color: var(--text); }
p { margin-bottom: 12px; color: var(--text); }
ul, ol { margin: 8px 0 16px 24px; }
li { margin-bottom: 4px; }
a { color: var(--blue); text-decoration: none; }
a:hover { text-decoration: underline; }

code {
    background: var(--bg3);
    padding: 2px 6px;
    border-radius: 4px;
    font-family: 'JetBrains Mono', 'Fira Code', monospace;
    font-size: 13px;
    color: var(--orange);
}
pre {
    background: var(--bg3);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 16px;
    overflow-x: auto;
    font-family: 'JetBrains Mono', 'Fira Code', monospace;
    font-size: 13px;
    line-height: 1.5;
    margin: 12px 0 20px;
    color: var(--text);
}

/* â”€â”€ Tabulky â”€â”€ */
table {
    width: 100%;
    border-collapse: collapse;
    margin: 12px 0 20px;
    font-size: 14px;
}
th, td {
    padding: 9px 14px;
    border: 1px solid var(--border);
    text-align: left;
}
th { background: var(--bg3); font-weight: 600; color: var(--text2); }
tr:hover td { background: var(--bg2); }

/* â”€â”€ Karty â”€â”€ */
.card-doc {
    background: var(--bg2);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 18px 20px;
    margin: 14px 0;
}
.card-doc.warning { border-color: var(--yellow); background: #1c1500; }
.card-doc.danger  { border-color: var(--red);    background: #1c0a0a; }
.card-doc.info    { border-color: var(--blue);   background: #0a1929; }
.card-doc.success { border-color: var(--green);  background: #0a1c0a; }
.card-doc .card-title {
    font-weight: 600;
    margin-bottom: 8px;
    font-size: 14px;
}
.card-doc p  { margin-bottom: 6px; }
.card-doc ul { margin: 6px 0 6px 20px; }
.card-doc pre {
    margin: 10px 0 0;
    background: var(--bg);
    border-color: var(--border);
}

/* â”€â”€ Badges â”€â”€ */
.badge {
    display: inline-block;
    padding: 2px 8px;
    border-radius: 10px;
    font-size: 11px;
    font-weight: 600;
}
.badge-green  { background: #0d2818; color: var(--green); }
.badge-yellow { background: #2a1e00; color: var(--yellow); }
.badge-red    { background: #2d0a0a; color: var(--red); }
.badge-blue   { background: #0c2d6b; color: var(--blue); }
.badge-purple { background: #271052; color: var(--purple); }

/* â”€â”€ Meta Å™Ã¡dek â”€â”€ */
.meta-row {
    display: flex;
    gap: 18px;
    flex-wrap: wrap;
    margin: 6px 0 24px;
    font-size: 13px;
    color: var(--text2);
}

/* â”€â”€ Back link â”€â”€ */
.btn-back {
    background: var(--blue);
    color: white !important;
    padding: 6px 14px;
    border-radius: 6px;
    text-decoration: none;
    font-weight: 600;
    font-size: 13px;
}
.btn-back:hover { opacity: 0.85; text-decoration: none; }

/* â”€â”€ Live Status Widget â”€â”€ */
.live-status {
    background: linear-gradient(135deg, #0d1117 0%, #1a1e2e 100%);
    border: 2px solid var(--green);
    border-radius: 12px;
    padding: 24px;
    margin: 24px 0;
}
.live-status h3 { color: var(--green); margin: 0 0 16px; display: flex; align-items: center; gap: 8px; }
.live-status > p { color: var(--text2); margin-bottom: 16px; }
.status-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
    gap: 12px;
}
.status-item { background: var(--bg2); border: 1px solid var(--border); border-radius: 8px; padding: 12px; }
.status-item-label { font-size: 11px; color: var(--text2); text-transform: uppercase; letter-spacing: 0.5px; }
.status-item-value { font-size: 18px; font-weight: 600; margin-top: 4px; }
.status-item-value.ok    { color: var(--green); }
.status-item-value.warn  { color: var(--yellow); }
.status-item-value.error { color: var(--red); }
.pulse {
    width: 8px; height: 8px;
    background: var(--green);
    border-radius: 50%;
    display: inline-block;
    flex-shrink: 0;
    animation: pulse-anim 2s ease-in-out infinite;
}
@keyframes pulse-anim { 0%, 100% { opacity: 1; } 50% { opacity: 0.3; } }

@media (max-width: 900px) {
    .sidebar { display: none; }
    .content { padding: 20px 16px; }
}
@media print {
    .top-bar, .sidebar { display: none !important; }
    .content { max-width: 100% !important; padding: 20px !important; }
    .layout  { display: block !important; }
    body     { background: white !important; color: black !important; }
    h1, h2, h3 { color: #003080 !important; }
    h2 { border-bottom: 1px solid #ccc !important; }
    pre, code { background: #f5f5f5 !important; border: 1px solid #ccc !important; color: black !important; }
    th  { background: #e8e8e8 !important; color: black !important; }
    td  { color: black !important; }
    .card-doc { background: #f9f9f9 !important; border: 1px solid #999 !important; color: black !important; }
    .card-doc.warning { background: #fff9e6 !important; border-color: #cc9900 !important; }
    .card-doc.danger  { background: #fff0f0 !important; border-color: #cc0000 !important; }
    .card-doc.info    { background: #f0f4ff !important; border-color: #0033cc !important; }
    .card-doc.success { background: #f0fff4 !important; border-color: #006600 !important; }
    .badge-green  { background: #d4edda !important; color: #155724 !important; }
    .badge-yellow { background: #fff3cd !important; color: #856404 !important; }
    .badge-red    { background: #f8d7da !important; color: #721c24 !important; }
    .badge-blue   { background: #d1ecf1 !important; color: #0c5460 !important; }
}
</style>
</head>
<body>

<div class="top-bar">
    <div class="top-bar-title">
        ğŸ“– Fedora Backup Dashboard <span style="font-weight:400;color:var(--text2)">v1.0.0</span>    </div>
    <div class="top-bar-meta">
        <span class="badge badge-green">active</span>
        <span>GenerovÃ¡no 2026-02-19 20:56</span>
        <a href="/" class="btn-back">ğŸ  ZpÄ›t na Dashboard</a>
    </div>
</div>

<div class="layout">

<nav class="sidebar">
    <h3>KÃ³d</h3>
    <a href="#moduly">ğŸ“¦ Moduly</a>
    <h3>Dokumentace</h3>
    <a href="#live-status">ğŸ“Š Live Status</a>
    <a href="#architektura">ğŸ—ƒï¸ Architektura</a>
    <a href="#vrstvy">ğŸ“š 3 vrstvy zÃ¡loh</a>
    <a href="#soubory">ğŸ“ Soubory a cesty</a>
    <a href="#dashboard">ğŸ–¥ï¸ Dashboard</a>
    <a href="#rucni-snapshot">ğŸ“¸ RuÄnÃ­ snapshot</a>
    <a href="#rucni-borg">ğŸ” RuÄnÃ­ Borg backup</a>
    <a href="#full-flow">ğŸš€ Full Flow (3-v-1)</a>
    <a href="#restore">â™»ï¸ ObnovenÃ­ dat</a>
    <a href="#rollback">âª Rollback systÃ©mu</a>
    <a href="#nuclear">â˜¢ï¸ Nuclear Delete</a>
    <a href="#cli-snapper">âŒ¨ï¸ CLI: Snapper</a>
    <a href="#cli-borg">âŒ¨ï¸ CLI: Borg</a>
    <a href="#cli-sync">âŒ¨ï¸ CLI: Btrfs Sync</a>
    <a href="#smazany-soubor">ğŸ”¥ ScÃ©nÃ¡Å™: SmazanÃ½ soubor</a>
    <a href="#rozbity-update">ğŸ”¥ ScÃ©nÃ¡Å™: RozbitÃ½ update</a>
    <a href="#mrtvy-disk">ğŸ”¥ ScÃ©nÃ¡Å™: MrtvÃ½ systÃ©movÃ½ disk</a>
    <a href="#ransomware">ğŸ”¥ ScÃ©nÃ¡Å™: Ransomware</a>
    <a href="#factory-reset">ğŸ”¥ ScÃ©nÃ¡Å™: Factory reset</a>
    <a href="#automaticke">â° AutomatickÃ© Ãºlohy</a>
    <a href="#monitoring">ğŸ“Š Monitoring</a>
    <a href="#rizika">âš ï¸ Rizika a limity</a>
</nav>

<main class="content">

<h1>Fedora Backup Dashboard</h1>

<p style="color:var(--text2);font-size:15px;margin-bottom:8px;">KompletnÃ­ dokumentace 3-vrstvÃ©ho zÃ¡lohovacÃ­ho systÃ©mu pro Fedora 43.</p>

<div class="meta-row">
<span>âš™ï¸ python, fastapi, jinja2, uvicorn</span><span>ğŸ”Œ port 8090</span><span>ğŸ“… aktualizovÃ¡no 2026-02-19</span></div>

<table>
    <thead><tr><th>SÃ­Å¥</th><th>URL</th></tr></thead>
    <tbody>
    <tr><td>LokÃ¡lnÃ­</td><td><code>http://localhost:8090</code></td></tr>
    <tr><td>LAN</td><td><code>http://192.168.0.101:8090</code></td></tr>
    <tr><td>Tailscale</td><td><code>http://fedora:8090</code></td></tr>
    </tbody>
</table>

<h2 id="moduly">ğŸ“¦ KÃ³dovÃ© moduly</h2>

<table>
    <thead><tr><th>Modul</th><th>Soubor</th><th>ÃšÄel</th><th>Status</th></tr></thead>
    <tbody>
    <tr>
        <td><strong>helpers.py</strong></td>
        <td><code>helpers.py</code></td>
        <td>SdÃ­lenÃ© utility: CONFIG, Jinja2 templates, logovÃ¡nÃ­, spouÅ¡tÄ›nÃ­ pÅ™Ã­kazÅ¯.</td>
        <td>
<span class="badge badge-green">stable</span>
        </td>
    </tr>
    <tr>
        <td><strong>routes/snapshots.py</strong></td>
        <td><code>routes/snapshots.py</code></td>
        <td>Snapper endpointy (create, delete, rollback, diff) a datovÃ¡ funkce get_snapper_list().</td>
        <td>
<span class="badge badge-green">stable</span>
        </td>
    </tr>
    <tr>
        <td><strong>routes/borg.py</strong></td>
        <td><code>routes/borg.py</code></td>
        <td>Borg Backup endpointy (create, delete, restore, files, tree) a datovÃ© funkce.</td>
        <td>
<span class="badge badge-green">stable</span>
        </td>
    </tr>
    <tr>
        <td><strong>routes/git.py</strong></td>
        <td><code>routes/git.py</code></td>
        <td>Git sprÃ¡va workspace pÅ™es web UI â€” log, diff, commit, rollback.</td>
        <td>
<span class="badge badge-green">stable</span>
        </td>
    </tr>
    <tr>
        <td><strong>routes/system.py</strong></td>
        <td><code>routes/system.py</code></td>
        <td>HlavnÃ­ dashboard endpointy: health, refresh, sync operace, logy, export, nuclear delete.</td>
        <td>
<span class="badge badge-green">stable</span>
        </td>
    </tr>
    </tbody>
</table>

<h3>
    helpers.py
<span style="font-size:13px;font-weight:400;color:var(--text2)">â€” <code>helpers.py</code></span></h3>
<p style="color:var(--text2);font-size:13px;">CONFIG dict obsahuje centrÃ¡lnÃ­ konfiguraci: cesty k diskÅ¯m, borg repo, excludes. templates = Jinja2Templates sdÃ­lenÃ¡ pro vÅ¡echny routery.</p><table>
    <thead><tr><th>Metoda</th><th>Parametry</th><th>VracÃ­</th><th>Popis</th></tr></thead>
    <tbody>
    <tr>
        <td><code>log_action()</code></td>
        <td><code style="font-size:12px;">message: str</code></td>
        <td>None</td>
        <td>ZapÃ­Å¡e akci do aplikaÄnÃ­ho logu (logs/dashboard.log).</td>
    </tr>
    <tr>
        <td><code>run_cmd()</code></td>
        <td><code style="font-size:12px;">cmd: list[str]</code></td>
        <td>str</td>
        <td>SpustÃ­ pÅ™Ã­kaz, vrÃ¡tÃ­ stdout. VyvolÃ¡ vÃ½jimku pÅ™i chybÄ›.</td>
    </tr>
    <tr>
        <td><code>run_sudo()</code></td>
        <td><code style="font-size:12px;">cmd: list[str]</code></td>
        <td>str</td>
        <td>SpustÃ­ pÅ™Ã­kaz pÅ™es sudo. Pro privilegovanÃ© operace (snapper, btrfs).</td>
    </tr>
    <tr>
        <td><code>get_borg_env()</code></td>
        <td><code style="font-size:12px;">â€”</code></td>
        <td>dict</td>
        <td>VrÃ¡tÃ­ env dict s BORG_PASSCOMMAND pro autentizaci Borg.</td>
    </tr>
    </tbody>
</table>
<h3>
    routes/snapshots.py
<span style="font-size:13px;font-weight:400;color:var(--text2)">â€” <code>routes/snapshots.py</code></span></h3>
<table>
    <thead><tr><th>Metoda</th><th>Parametry</th><th>VracÃ­</th><th>Popis</th></tr></thead>
    <tbody>
    <tr>
        <td><code>get_snapper_list()</code></td>
        <td><code style="font-size:12px;">â€”</code></td>
        <td>list[dict]</td>
        <td>VrÃ¡tÃ­ seznam Snapper snapshotÅ¯. ImportovÃ¡na a volÃ¡na v routes/system.py pro dashboard.</td>
    </tr>
    </tbody>
</table>
<h3>
    routes/borg.py
<span style="font-size:13px;font-weight:400;color:var(--text2)">â€” <code>routes/borg.py</code></span></h3>
<table>
    <thead><tr><th>Metoda</th><th>Parametry</th><th>VracÃ­</th><th>Popis</th></tr></thead>
    <tbody>
    <tr>
        <td><code>get_borg_archives()</code></td>
        <td><code style="font-size:12px;">â€”</code></td>
        <td>list[dict]</td>
        <td>VrÃ¡tÃ­ seznam Borg archivÅ¯. ImportovÃ¡na v routes/system.py.</td>
    </tr>
    <tr>
        <td><code>get_borg_info()</code></td>
        <td><code style="font-size:12px;">â€”</code></td>
        <td>dict</td>
        <td>VrÃ¡tÃ­ info o Borg repu (size, num_archives, last_modified).</td>
    </tr>
    </tbody>
</table>
<h3>
    routes/git.py
<span style="font-size:13px;font-weight:400;color:var(--text2)">â€” <code>routes/git.py</code></span></h3>
<p style="color:var(--text2);font-size:13px;">Web UI dostupnÃ© na /git. SlouÅ¾Ã­ pro commitovÃ¡nÃ­ zmÄ›n v ~/projects/ z prohlÃ­Å¾eÄe.</p><table>
    <thead><tr><th>Metoda</th><th>Parametry</th><th>VracÃ­</th><th>Popis</th></tr></thead>
    <tbody>
    <tr>
        <td><code>get_git_log()</code></td>
        <td><code style="font-size:12px;">â€”</code></td>
        <td>list[dict]</td>
        <td>Historie commitÅ¯ (hash, zprÃ¡va, datum, autor).</td>
    </tr>
    <tr>
        <td><code>get_git_status()</code></td>
        <td><code style="font-size:12px;">â€”</code></td>
        <td>dict</td>
        <td>AktuÃ¡lnÃ­ git status â€” staged a unstaged soubory.</td>
    </tr>
    <tr>
        <td><code>get_git_diff()</code></td>
        <td><code style="font-size:12px;">commit: str</code></td>
        <td>str</td>
        <td>TextovÃ½ diff konkrÃ©tnÃ­ho commitu.</td>
    </tr>
    </tbody>
</table>
<h3>
    routes/system.py
<span style="font-size:13px;font-weight:400;color:var(--text2)">â€” <code>routes/system.py</code></span></h3>
<table>
    <thead><tr><th>Metoda</th><th>Parametry</th><th>VracÃ­</th><th>Popis</th></tr></thead>
    <tbody>
    <tr>
        <td><code>get_backup_disk_status()</code></td>
        <td><code style="font-size:12px;">â€”</code></td>
        <td>dict</td>
        <td>Stav backup disku: mounted, used_percent, free, total.</td>
    </tr>
    <tr>
        <td><code>get_root_disk_status()</code></td>
        <td><code style="font-size:12px;">â€”</code></td>
        <td>dict</td>
        <td>Stav root disku: used_percent, free, total.</td>
    </tr>
    <tr>
        <td><code>get_health_status()</code></td>
        <td><code style="font-size:12px;">â€”</code></td>
        <td>dict</td>
        <td>AgregovanÃ½ health check: snapshots, borg, disky, timery. VracÃ­ seznam warnings.</td>
    </tr>
    <tr>
        <td><code>get_systemd_timers()</code></td>
        <td><code style="font-size:12px;">â€”</code></td>
        <td>list[dict]</td>
        <td>Stav systemd timerÅ¯ (borg-backup, snapshot-sync, snapper-timeline, snapper-cleanup).</td>
    </tr>
    <tr>
        <td><code>get_sync_snapshots()</code></td>
        <td><code style="font-size:12px;">â€”</code></td>
        <td>list[dict]</td>
        <td>Seznam snapshotÅ¯ na backup disku (/mnt/fedora-backups/system-snapshots/).</td>
    </tr>
    <tr>
        <td><code>get_dashboard_log()</code></td>
        <td><code style="font-size:12px;">n: int = 100</code></td>
        <td>list[str]</td>
        <td>PoslednÃ­ch N Å™Ã¡dkÅ¯ z logs/dashboard.log.</td>
    </tr>
    </tbody>
</table>

<h2 id="live-status">ğŸ“Š Live Status</h2>


<div class="live-status">
    <h3>
        <span class="pulse"></span>
        Live Project Status
        <button onclick="updateLiveStatus()" style="background:var(--bg3);border:1px solid var(--border);color:var(--text2);padding:4px 10px;border-radius:6px;cursor:pointer;font-size:13px;margin-left:8px;" title="Aktualizovat">ğŸ”„</button>
    </h3>
    <p>AktuÃ¡lnÃ­ stav systÃ©mu &nbsp;|&nbsp; KliknÄ›te ğŸ”„ pro aktualizaci</p>
    <div class="status-grid">
        <div class="status-item"><div class="status-item-label">Dashboard</div><div class="status-item-value ok" id="status-dashboard">â— Running</div></div>
        <div class="status-item"><div class="status-item-label">Snapper Snapshoty</div><div class="status-item-value" id="status-snapshots">â€”</div></div>
        <div class="status-item"><div class="status-item-label">Borg Archivy</div><div class="status-item-value" id="status-borg">â€”</div></div>
        <div class="status-item"><div class="status-item-label">Backup Disk</div><div class="status-item-value" id="status-disk">â€”</div></div>
        <div class="status-item"><div class="status-item-label">Root Disk</div><div class="status-item-value" id="status-root">â€”</div></div>
        <div class="status-item"><div class="status-item-label">PoslednÃ­ Borg</div><div class="status-item-value" id="status-last-borg">â€”</div></div>
        <div class="status-item"><div class="status-item-label">PoslednÃ­ Sync</div><div class="status-item-value" id="status-last-sync">â€”</div></div>
        <div class="status-item"><div class="status-item-label">Health Status</div><div class="status-item-value" id="status-health">â€”</div></div>
    </div>
    <div style="margin-top:16px;font-size:13px;color:var(--text2);">
        <strong>PoslednÃ­ update:</strong> <span id="status-timestamp">â€”</span>
    </div>
</div>
<script>
async function updateLiveStatus() {
    const set = (id, text, cls) => {
        const el = document.getElementById(id);
        if (!el) return;
        el.textContent = text;
        el.className = 'status-item-value' + (cls ? ' ' + cls : '');
    };
    try {
        const r = await fetch('/api/health');
        const data = await r.json();
        if (data.snapshots?.count !== undefined) set('status-snapshots', data.snapshots.count, 'ok');
        if (data.borg?.count !== undefined) set('status-borg', data.borg.count, 'ok');
        if (data.backup_disk) {
            if (data.backup_disk.mounted)
                set('status-disk', data.backup_disk.used_percent + '% pouÅ¾ito', data.backup_disk.used_percent > 85 ? 'warn' : 'ok');
            else
                set('status-disk', 'âš  Unmounted', 'error');
        }
        if (data.root_disk)
            set('status-root', data.root_disk.used_percent + '% pouÅ¾ito', data.root_disk.used_percent > 85 ? 'warn' : 'ok');
        if (data.borg?.last_backup) set('status-last-borg', data.borg.last_backup, 'ok');
        if (data.sync?.last_run) set('status-last-sync', data.sync.last_run, 'ok');
        if (data.warnings !== undefined)
            set('status-health', data.warnings.length === 0 ? 'âœ“ OK' : 'âš  ' + data.warnings.length + ' varovÃ¡nÃ­', data.warnings.length === 0 ? 'ok' : 'warn');
        document.getElementById('status-timestamp').textContent = new Date().toLocaleString('cs-CZ');
    } catch(e) {
        set('status-dashboard', 'âš  Offline', 'error');
    }
}
updateLiveStatus();
</script>

<h2 id="architektura">ğŸ—ƒï¸ Architektura</h2>


<p>3-vrstvÃ¡ zÃ¡lohovacÃ­ architektura: Snapper snapshoty (vrstva 1), Btrfs sync na zÃ¡loÅ¾nÃ­ disk (vrstva 2) a Borg backup Å¡ifrovanÃ½ch dat (vrstva 3). VÅ¡e ovlÃ¡dÃ¡no pÅ™es Dashboard na portu 8090.</p>


<table>
    <thead>
    <tr><th>Komponenta</th><th>Technologie</th><th>Co zÃ¡lohuje</th><th>Kam</th></tr>
    </thead>
    <tbody>
    <tr><td><span class="badge badge-green">Vrstva 1</span> Snapper</td><td>Btrfs snapshoty</td><td>CelÃ½ root filesystem <code>/</code></td><td><code>/.snapshots/</code> (lokÃ¡lnÃ­)</td></tr>
    <tr><td><span class="badge badge-yellow">Vrstva 2</span> Btrfs Sync</td><td>btrfs send/receive</td><td>Kopie snapshotÅ¯ z /.snapshots/</td><td><code>/mnt/fedora-backups/system-snapshots/</code></td></tr>
    <tr><td><span class="badge badge-purple">Vrstva 3</span> Borg</td><td>Borg Backup (Å¡ifrovanÃ½, dedup)</td><td><code>/home/geo/</code></td><td><code>/mnt/fedora-backups/borg-repo/</code></td></tr>
    </tbody>
</table>

<h2 id="vrstvy">ğŸ“š 3 vrstvy zÃ¡loh</h2>


<h3>Vrstva 1: Snapper (Btrfs snapshoty)</h3>


<div class="card-doc info">
    <div class="card-title">ğŸ“¸ LokÃ¡lnÃ­ snapshoty celÃ©ho systÃ©mu</div>
    <ul>
<li><strong>Co:</strong> AtomickÃ½ snapshot Btrfs subvolumu <code>/</code></li>
<li><strong>Kdy automaticky:</strong> KaÅ¾dou hodinu (timeline), pÅ™ed/po DNF operacÃ­ch</li>
<li><strong>Retence:</strong> 5 hodinovÃ½ch, 7 dennÃ­ch, 4 tÃ½dennÃ­ch, 6 mÄ›sÃ­ÄnÃ­ch, 2 roÄnÃ­ch</li>
<li><strong>Rychlost:</strong> OkamÅ¾itÃ½ (&lt; 1 sekunda)</li>
<li><strong>Rollback:</strong> <code>snapper rollback ÄŒÃSLO</code> + reboot</li>
<li><strong>GOLDEN snapshot:</strong> ReferenÄnÃ­ ÄistÃ½ stav systÃ©mu, chrÃ¡nÄ›nÃ½ pÅ™ed smazÃ¡nÃ­m</li>
    </ul>
</div>


<h3>Vrstva 2: Btrfs Send/Receive</h3>


<div class="card-doc info">
    <div class="card-title">ğŸ”„ Sync snapshotÅ¯ na zÃ¡loÅ¾nÃ­ disk</div>
    <ul>
<li><strong>Co:</strong> Kopie snapshotÅ¯ z <code>/.snapshots/</code> na <code>/mnt/fedora-backups/</code></li>
<li><strong>Kdy:</strong> DennÄ› ve 03:32 (systemd timer)</li>
<li><strong>ÃšÄel:</strong> ZÃ¡chrana pÅ™i selhÃ¡nÃ­ systÃ©movÃ©ho disku</li>
<li><strong>Typ:</strong> InkrementÃ¡lnÃ­ (pouze zmÄ›ny)</li>
    </ul>
</div>


<h3>Vrstva 3: Borg Backup</h3>


<div class="card-doc info">
    <div class="card-title">ğŸ” Å ifrovanÃ© zÃ¡lohy /home</div>
    <ul>
<li><strong>Co:</strong> CelÃ½ <code>/home/geo/</code> (s excludes: cache, thinclient_drives)</li>
<li><strong>Kdy:</strong> DennÄ› ve 03:13 (systemd timer)</li>
<li><strong>Å ifrovÃ¡nÃ­:</strong> Ano (passphrase v <code>~/.borg-passphrase</code>)</li>
<li><strong>Deduplikace:</strong> Ano (identickÃ© bloky uloÅ¾eny jen jednou)</li>
<li><strong>Komprese:</strong> zstd</li>
<li><strong>Browse:</strong> ProchÃ¡zenÃ­ souborÅ¯ v archivu a obnovenÃ­ jednotlivÃ½ch souborÅ¯</li>
    </ul>
</div>

<h2 id="soubory">ğŸ“ Soubory a cesty</h2>


<table>
    <thead>
    <tr><th>Cesta</th><th>Popis</th></tr>
    </thead>
    <tbody>
    <tr><td><code>~/projects/backup-dashboard/app.py</code></td><td>HlavnÃ­ aplikace dashboardu</td></tr>
    <tr><td><code>~/projects/backup-dashboard/templates/</code></td><td>HTML Å¡ablony (Jinja2)</td></tr>
    <tr><td><code>~/projects/backup-dashboard/logs/dashboard.log</code></td><td>AplikaÄnÃ­ log</td></tr>
    <tr><td><code>/etc/systemd/system/backup-dashboard.service</code></td><td>Systemd service (system)</td></tr>
    <tr><td><code>/.snapshots/</code></td><td>Snapper snapshoty (lokÃ¡lnÃ­, na root disku)</td></tr>
    <tr><td><code>/mnt/fedora-backups/borg-repo/</code></td><td>Borg repository (Å¡ifrovanÃ¡)</td></tr>
    <tr><td><code>/mnt/fedora-backups/system-snapshots/</code></td><td>Sync snapshoty z Vrstva 2</td></tr>
    <tr><td><code>~/.borg-passphrase</code></td><td>Borg heslo (chraÅˆ jako klÃ­Ä!)</td></tr>
    <tr><td><code>~/borg-key-backup.txt</code></td><td>ExportovanÃ½ Borg klÃ­Ä (zÃ¡loha)</td></tr>
    </tbody>
</table>

<h2 id="dashboard">ğŸ–¥ï¸ Dashboard</h2>


<p>Dashboard je dostupnÃ½ na:</p>


<ul>
<li>LokÃ¡lnÄ›: <code>http://localhost:8090/</code></li>
<li>Ze sÃ­tÄ›: <code>http://192.168.0.101:8090/</code></li>
<li>PÅ™es Tailscale: <code>http://fedora:8090/</code></li>
</ul>


<h3>Sekce dashboardu</h3>


<table>
    <thead>
    <tr><th>Sekce</th><th>Funkce</th></tr>
    </thead>
    <tbody>
    <tr><td>ğŸ’¾ Disky</td><td>Stav root a backup disku, vyuÅ¾itÃ­ mÃ­sta</td></tr>
    <tr><td>â° AutomatickÃ© Ãºlohy</td><td>Stav systemd timerÅ¯, pÅ™Ã­Å¡tÃ­/poslednÃ­ spuÅ¡tÄ›nÃ­</td></tr>
    <tr><td>ğŸ“¸ Snapper Snapshoty</td><td>Seznam, vytvoÅ™enÃ­, smazÃ¡nÃ­, diff, rollback</td></tr>
    <tr><td>ğŸ” Borg Archivy</td><td>Seznam, vytvoÅ™enÃ­, browse souborÅ¯, restore, smazÃ¡nÃ­</td></tr>
    <tr><td>ğŸ”„ Btrfs Sync</td><td>RuÄnÃ­ sync snapshotÅ¯ na backup disk</td></tr>
    <tr><td>ğŸš€ Full Flow</td><td>KompletnÃ­ zÃ¡loha v jednom kroku (snapshot + borg + sync)</td></tr>
    <tr><td>â˜¢ï¸ Nuclear Delete</td><td>SmazÃ¡nÃ­ vÅ¡ech zÃ¡loh (chrÃ¡nÄ›no heslem + 2Ã— potvrzenÃ­m)</td></tr>
    <tr><td>ğŸ“‹ Log</td><td>Historie akcÃ­ dashboardu, export, smazÃ¡nÃ­</td></tr>
    </tbody>
</table>

<h2 id="rucni-snapshot">ğŸ“¸ RuÄnÃ­ snapshot</h2>


<ol>
<li>OtevÅ™i dashboard</li>
<li>V sekci <strong>Snapper Snapshoty</strong> zadej popis (napÅ™. "PÅ™ed instalacÃ­ NVIDIA")</li>
<li>Klikni <strong>+ Snapshot</strong></li>
<li>Snapshot se vytvoÅ™Ã­ okamÅ¾itÄ› (&lt; 1 s)</li>
</ol>


<div class="card-doc success">
    <div class="card-title">ğŸ’¡ Tip</div>
<p>VÅ¾dy dÄ›lej snapshot PÅ˜ED rizikovÃ½mi operacemi: aktualizace kernelu, instalace ovladaÄÅ¯, zmÄ›ny konfigurace.</p></div>

<h2 id="rucni-borg">ğŸ” RuÄnÃ­ Borg backup</h2>


<ol>
<li>V sekci <strong>Borg Archivy</strong> zadej komentÃ¡Å™</li>
<li>Klikni <strong>+ Backup</strong></li>
<li>Backup trvÃ¡ podle velikosti dat (typicky 1â€“5 minut)</li>
<li>NÃ¡zev archivu: <code>[komentÃ¡Å™-slug]-[YYYYMMDD-HHMMSS]</code></li>
</ol>

<h2 id="full-flow">ğŸš€ Full Flow (3-v-1)</h2>


<p>Provede kompletnÃ­ zÃ¡lohu ve 3 krocÃ­ch:</p>


<ol>
<li><span class="badge badge-blue">Krok 1</span> VytvoÅ™Ã­ Snapper snapshot (popis s prefixem [FULL])</li>
<li><span class="badge badge-purple">Krok 2</span> SpustÃ­ Borg backup celÃ©ho /home</li>
<li><span class="badge badge-yellow">Krok 3</span> Sync snapshotÅ¯ na backup disk</li>
</ol>


<div class="card-doc warning">
    <div class="card-title">â±ï¸ ÄŒas</div>
<p>Full Flow trvÃ¡ typicky 2â€“10 minut. StrÃ¡nka se po dokonÄenÃ­ automaticky refreshne.</p></div>

<h2 id="restore">â™»ï¸ ObnovenÃ­ dat</h2>


<h3>Ze Snapper snapshotu (systÃ©movÃ© soubory)</h3>


<pre># Najdi snapshot
sudo snapper -c root list

# ProchÃ¡zej soubory
ls /.snapshots/ÄŒÃSLO/snapshot/cesta/k/souboru

# KopÃ­ruj zpÄ›t
sudo cp /.snapshots/ÄŒÃSLO/snapshot/etc/config.conf /etc/config.conf</pre>


<h3>Z Borg archivu (home soubory) â€” pÅ™es Dashboard</h3>


<ol>
<li>Klikni â™»ï¸ u archivu v sekci Borg Archivy</li>
<li>ProchÃ¡zej adresÃ¡Å™ovou strukturu (klik na ğŸ“ sloÅ¾ky)</li>
<li>Vyber soubor/sloÅ¾ku kliknutÃ­m na â˜‘ï¸</li>
<li>Zvol reÅ¾im: <strong>Do cÃ­lovÃ© sloÅ¾ky</strong> (bezpeÄnÃ©) nebo <strong>Na pÅ¯vodnÃ­ mÃ­sto</strong> (pÅ™epÃ­Å¡e)</li>
<li>Klikni <strong>Obnovit</strong></li>
</ol>


<h3>Z Borg archivu â€” pÅ™es CLI</h3>


<pre>export BORG_PASSCOMMAND=&quot;cat ~/.borg-passphrase&quot;

# Seznam archivÅ¯
borg list /mnt/fedora-backups/borg-repo

# Obnovit jeden soubor
cd /tmp
borg extract /mnt/fedora-backups/borg-repo::ARCHIV home/geo/cesta/soubor

# Obnovit vÅ¡e
cd /
borg extract /mnt/fedora-backups/borg-repo::ARCHIV</pre>

<h2 id="rollback">âª Rollback systÃ©mu</h2>


<div class="card-doc danger">
    <div class="card-title">âš ï¸ Rollback vrÃ¡tÃ­ CELÃ systÃ©m do stavu snapshotu</div>
<p>VÅ¡echny zmÄ›ny po snapshotu budou ztraceny. /home zÅ¯stane nedotÄen (je na zvlÃ¡Å¡tnÃ­m subvolumu jen pokud je separÃ¡tnÃ­).</p></div>


<h3>Z dashboardu</h3>


<ol>
<li>Klikni âª u snapshotu</li>
<li>PotvrÄ 2Ã— bezpeÄnostnÃ­ dialog</li>
<li><strong>RESTARTUJ systÃ©m</strong> â€” rollback se dokonÄÃ­ aÅ¾ po rebootu</li>
</ol>


<h3>Z CLI</h3>


<pre>sudo snapper -c root rollback ÄŒÃSLO
sudo reboot</pre>


<h3>Z GRUBu (systÃ©m nebootuje)</h3>


<ol>
<li>PÅ™i startu vyber <strong>Fedora Snapshots</strong> v GRUB menu</li>
<li>Vyber poÅ¾adovanÃ½ snapshot</li>
<li>Po nabootovÃ¡nÃ­ spusÅ¥: <code>sudo snapper -c root rollback ÄŒÃSLO &amp;&amp; sudo reboot</code></li>
</ol>

<h2 id="nuclear">â˜¢ï¸ Nuclear Delete</h2>


<div class="card-doc danger">
    <div class="card-title">NEVRATNÃ‰ smazÃ¡nÃ­ vÅ¡ech zÃ¡loh</div>
<p>ChrÃ¡nÄ›no: heslem + potvrzovacÃ­m textem <code>SMAZAT VSE</code> + 2Ã— confirm dialog. SmaÅ¾e:</p>    <ul>
<li>VÅ¡echny Snapper snapshoty (kromÄ› #0 current a GOLDEN)</li>
<li>VÅ¡echny Borg archivy</li>
<li>VÅ¡echny sync snapshoty z backup disku</li>
    </ul>
</div>

<h2 id="cli-snapper">âŒ¨ï¸ CLI: Snapper</h2>


<pre># Seznam snapshotÅ¯
sudo snapper -c root list

# VytvoÅ™it snapshot
sudo snapper -c root create --description &quot;Popis&quot; --print-number

# Diff mezi snapshoty
sudo snapper -c root status ÄŒÃSLO1..ÄŒÃSLO2

# Rollback
sudo snapper -c root rollback ÄŒÃSLO
sudo reboot

# Smazat snapshot
sudo snapper -c root delete ÄŒÃSLO

# Konfigurace
sudo snapper -c root get-config</pre>

<h2 id="cli-borg">âŒ¨ï¸ CLI: Borg</h2>


<pre>export BORG_PASSCOMMAND=&quot;cat ~/.borg-passphrase&quot;

# Seznam archivÅ¯
borg list /mnt/fedora-backups/borg-repo

# Info o repu
borg info /mnt/fedora-backups/borg-repo

# VytvoÅ™it backup
borg create --compression zstd --one-file-system \
  /mnt/fedora-backups/borg-repo::nazev-DATUM \
  /home/geo \
  --exclude &#x27;*.cache*&#x27; --exclude &#x27;thinclient_drives&#x27;

# ProchÃ¡zet archiv
borg list /mnt/fedora-backups/borg-repo::ARCHIV

# Obnovit do /tmp
cd /tmp &amp;&amp; borg extract /mnt/fedora-backups/borg-repo::ARCHIV

# Mountnout jako FS
borg mount /mnt/fedora-backups/borg-repo::ARCHIV /mnt/borg-mount

# Kontrola integrity
borg check /mnt/fedora-backups/borg-repo

# Compact (uvolnit mÃ­sto po smazÃ¡nÃ­ archivÅ¯)
borg compact /mnt/fedora-backups/borg-repo</pre>

<h2 id="cli-sync">âŒ¨ï¸ CLI: Btrfs Sync</h2>


<pre># RuÄnÃ­ spuÅ¡tÄ›nÃ­
sudo systemctl start snapshot-sync.service

# Log
sudo cat /var/log/backup-snapshot-sync.log

# Stav timeru
systemctl status snapshot-sync.timer</pre>

<h2 id="smazany-soubor">ğŸ”¥ ScÃ©nÃ¡Å™: SmazanÃ½ soubor</h2>


<h3>SystÃ©movÃ½ soubor (konfigurace, binÃ¡rka)</h3>


<div class="card-doc ">
    <div class="card-title">Ze Snapper snapshotu</div>
<pre>sudo ls /.snapshots/ÄŒÃSLO/snapshot/cesta/
sudo cp /.snapshots/ÄŒÃSLO/snapshot/etc/soubor /etc/soubor</pre></div>


<h3>Home soubor</h3>


<div class="card-doc ">
    <div class="card-title">Z Borg archivu</div>
<pre>export BORG_PASSCOMMAND=&quot;cat ~/.borg-passphrase&quot;
cd /tmp
borg extract /mnt/fedora-backups/borg-repo::ARCHIV home/geo/soubor</pre></div>


<p>Nebo pÅ™es Dashboard â†’ Borg â†’ â™»ï¸ Restore</p>

<h2 id="rozbity-update">ğŸ”¥ ScÃ©nÃ¡Å™: RozbitÃ½ update</h2>


<h3>SystÃ©m bootuje</h3>


<div class="card-doc ">
    <div class="card-title">SystÃ©m bootuje â€” rollback pÅ™es CLI</div>
<pre>sudo snapper -c root list          # najÃ­t pre-dnf snapshot
sudo snapper -c root rollback ÄŒÃSLO
sudo reboot</pre></div>


<h3>SystÃ©m NEBOOTUJE</h3>


<div class="card-doc ">
    <div class="card-title">SystÃ©m nebootuje â€” GRUB recovery</div>
    <ul>
<li>GRUB â†’ <strong>Fedora Snapshots</strong> â†’ vyber snapshot â†’ boot</li>
<li>Po nabootovÃ¡nÃ­: <code>sudo snapper -c root rollback ÄŒÃSLO &amp;&amp; sudo reboot</code></li>
    </ul>
</div>

<h2 id="mrtvy-disk">ğŸ”¥ ScÃ©nÃ¡Å™: MrtvÃ½ systÃ©movÃ½ disk</h2>


<div class="card-doc danger">
    <div class="card-title">KompletnÃ­ obnova z backup disku</div>
<pre># 1. Boot z Live USB
# 2. PÅ™iprav novÃ½ disk
mkfs.btrfs -L fedora /dev/NEW_DISK
mount /dev/NEW_DISK /mnt/new
mount /dev/nvme0n1p1 /mnt/backup

# 3. Obnov systÃ©m ze snapshotu
ls /mnt/backup/system-snapshots/
btrfs send /mnt/backup/system-snapshots/SNAPSHOT | btrfs receive /mnt/new/
mv /mnt/new/SNAPSHOT /mnt/new/root
btrfs subvolume set-default /mnt/new/root

# 4. Reinstall GRUB + oprav fstab
# 5. Reboot

# 6. Obnov /home
export BORG_PASSCOMMAND=&quot;cat /cesta/k/passphrase&quot;
cd / &amp;&amp; borg extract /mnt/backup/borg-repo::ARCHIV</pre></div>

<h2 id="ransomware">ğŸ”¥ ScÃ©nÃ¡Å™: Ransomware</h2>


<div class="card-doc ">
    <div class="card-title">Postup obnovy po ransomware Ãºtoku</div>
<pre># 1. ODPOJ poÄÃ­taÄ od sÃ­tÄ› OKAMÅ½ITÄš
# 2. Boot z Live USB

# 3. Obnov systÃ©m ze snapshotu PÅ˜ED Ãºtokem
sudo snapper -c root rollback ÄŒÃSLO

# 4. Obnov home z Borg archivu PÅ˜ED Ãºtokem
export BORG_PASSCOMMAND=&quot;cat ~/.borg-passphrase&quot;
borg list /mnt/fedora-backups/borg-repo    # najdi archiv PÅ˜ED datem Ãºtoku
cd / &amp;&amp; borg extract /mnt/fedora-backups/borg-repo::ARCHIV</pre></div>

<h2 id="factory-reset">ğŸ”¥ ScÃ©nÃ¡Å™: Factory reset</h2>


<div class="card-doc success">
    <div class="card-title">NÃ¡vrat na GOLDEN snapshot</div>
<pre>sudo snapper -c root list     # najdi GOLDEN snapshot
sudo snapper -c root rollback ÄŒÃSLO_GOLDEN
sudo reboot</pre></div>


<p>Nebo pÅ™es Dashboard â†’ klikni âª u GOLDEN snapshotu</p>

<h2 id="automaticke">â° AutomatickÃ© Ãºlohy</h2>


<table>
    <thead>
    <tr><th>Timer</th><th>Kdy</th><th>Co dÄ›lÃ¡</th></tr>
    </thead>
    <tbody>
    <tr><td><code>snapper-timeline.timer</code></td><td>KaÅ¾dou hodinu</td><td>VytvoÅ™Ã­ timeline snapshot</td></tr>
    <tr><td><code>snapper-cleanup.timer</code></td><td>KaÅ¾dou hodinu</td><td>SmaÅ¾e starÃ© snapshoty dle retence</td></tr>
    <tr><td><code>borg-backup.timer</code></td><td>DennÄ› ~03:13</td><td>Borg backup /home/geo</td></tr>
    <tr><td><code>snapshot-sync.timer</code></td><td>DennÄ› ~03:32</td><td>Btrfs send/receive na backup disk</td></tr>
    </tbody>
</table>


<pre># OvÄ›Å™enÃ­ stavu timerÅ¯
systemctl list-timers | grep -iE &#x27;borg|snapshot|snapper&#x27;</pre>

<h2 id="monitoring">ğŸ“Š Monitoring</h2>


<pre># ZdravÃ­ systÃ©mu (JSON)
curl -s http://localhost:8090/api/health | python3 -m json.tool

# MÃ­sto na discÃ­ch
df -h / /mnt/fedora-backups

# Je backup disk mounted?
mountpoint /mnt/fedora-backups

# PoslednÃ­ borg backup
export BORG_PASSCOMMAND=&quot;cat ~/.borg-passphrase&quot;
borg list /mnt/fedora-backups/borg-repo --last 1

# Dashboard log
tail -20 ~/projects/backup-dashboard/logs/dashboard.log

# Systemd logy
sudo journalctl -u borg-backup.service --since today
sudo journalctl -u snapshot-sync.service --since today
sudo journalctl -u backup-dashboard.service -n 20</pre>

<h2 id="rizika">âš ï¸ Rizika a limity</h2>


<div class="card-doc danger">
    <div class="card-title">ğŸ”‘ Borg klÃ­Ä a heslo</div>
<p>Bez <code>~/.borg-passphrase</code> a <code>~/borg-key-backup.txt</code> jsou Borg zÃ¡lohy <strong>NEÄŒITELNÃ‰</strong>. UloÅ¾ kopie mimo tento poÄÃ­taÄ: USB disk, cloud, tisk na papÃ­r.</p></div>


<div class="card-doc warning">
    <div class="card-title">ğŸŒ Å½Ã¡dnÃ½ offsite backup</div>
<p>ObÄ› zÃ¡lohy (Snapper i Borg) jsou fyzicky na stejnÃ©m mÃ­stÄ›. KrÃ¡deÅ¾, poÅ¾Ã¡r nebo pÅ™epÄ›tÃ­ = ztrÃ¡ta vÅ¡eho. ZvaÅ¾: BorgBase, rsync.net, druhÃ½ PC, NAS.</p></div>


<div class="card-doc warning">
    <div class="card-title">ğŸ’¾ Backup disk musÃ­ bÃ½t mounted</div>
<p>Pokud <code>/mnt/fedora-backups</code> nenÃ­ pÅ™ipojen, Borg i Sync zÃ¡lohy <strong>selÅ¾ou tiÅ¡e</strong>. Dashboard zobrazuje varovÃ¡nÃ­, ale automatickÃ© Ãºlohy mohou selhat bez notifikace.</p></div>


<div class="card-doc info">
    <div class="card-title">ğŸ“ Limity</div>
    <ul>
<li>Snapper snapshoty zabÃ­rajÃ­ mÃ­sto na root disku ÃºmÄ›rnÄ› zmÄ›nÃ¡m â€” sleduj <code>df -h /</code></li>
<li>Borg deduplikace Å¡etÅ™Ã­ mÃ­sto, ale repo roste s Äasem â€” pravidelnÄ› spouÅ¡tÄ›j <code>borg compact</code></li>
<li>Dashboard bÄ›Å¾Ã­ jako root (nutnÃ© pro snapper/btrfs operace)</li>
<li>Restore z dashboardu zatÃ­m v development fÃ¡zi</li>
    </ul>
</div>


</main>
</div>

<script>
// ZvÃ½raznÄ›nÃ­ aktivnÃ­ sekce v sidebar pÅ™i scrollu
const headings = document.querySelectorAll('h2[id]');
const links    = document.querySelectorAll('.sidebar a');

const observer = new IntersectionObserver(entries => {
    entries.forEach(entry => {
        if (entry.isIntersecting) {
            links.forEach(l => l.classList.remove('active'));
            const active = document.querySelector(`.sidebar a[href="#${entry.target.id}"]`);
            if (active) active.classList.add('active');
        }
    });
}, { threshold: 0.2, rootMargin: '-52px 0px -60% 0px' });

headings.forEach(h => observer.observe(h));
</script>

</body>
</html>