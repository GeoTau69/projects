{% extends "base.html" %}
{% set active = 'templates' %}
{% block title %}Šablony — Agent UI{% endblock %}

{% block content %}
<section>
  <h2>Šablony</h2>

  {# Formulář pro novou šablonu #}
  <div style="background:#161b22; border:1px solid #30363d; border-radius:3px; padding:1rem; margin-bottom:1.5rem;">
    <div style="color:#8b949e; font-size:0.7rem; letter-spacing:3px; margin-bottom:0.75rem;">NOVÁ ŠABLONA</div>
    <form method="post" action="/templates/new">
      <div class="form-row">
        <label>Název</label>
        <input type="text" name="name" placeholder="např. Code Review" style="max-width:300px;">
      </div>
      <div class="form-row">
        <label>Obsah (system prompt)</label>
        <textarea name="content" rows="4" placeholder="Jsi expert na…"></textarea>
      </div>
      <button type="submit">+ Přidat šablonu</button>
    </form>
  </div>

  {# Seznam šablon #}
  {% if templates %}
    {% for t in templates %}
    <div style="background:#161b22; border:1px solid #21262d; border-radius:3px; padding:0.75rem 1rem; margin-bottom:0.75rem; display:flex; gap:1rem; align-items:flex-start;">
      <div style="flex:1;">
        <div style="color:#e6edf3; font-size:0.9rem; margin-bottom:0.4rem;">{{ t.name }}</div>
        <div style="color:#8b949e; font-size:0.8rem; white-space:pre-wrap; line-height:1.5;">{{ t.content }}</div>
        <div style="color:#484f58; font-size:0.7rem; margin-top:0.4rem;">
          {{ t.created_at[:16] if t.created_at else '' }}
          · {{ t.content | length }} znaků
          · {{ t.content.split() | length }} slov
        </div>
      </div>
      <div style="display:flex; flex-direction:column; gap:0.3rem; flex-shrink:0;">
        <a href="/templates/{{ t.id }}/edit" style="font-size:0.75rem; color:#58a6ff;">upravit</a>
        <form method="post" action="/templates/{{ t.id }}/delete" style="margin:0;">
          <button type="submit" style="background:none; border:none; color:#f85149; cursor:pointer; font-size:0.75rem; padding:0;"
                  onclick="return confirm('Smazat šablonu?')">smazat</button>
        </form>
      </div>
    </div>
    {% endfor %}
  {% else %}
    <div style="color:#484f58; font-size:0.85rem;">Zatím žádné šablony.</div>
  {% endif %}
</section>
{% endblock %}
