{
  "project": "ai",
  "display_name": "AI Dev Agent Stack",
  "version": "1.0.0",
  "updated": "2026-02-20",
  "description": "KomplexnÃ­ sada nÃ¡strojÅ¯ pro optimalizaci a sprÃ¡vu prÃ¡ce s AI. Zahrnuje ÃºÄetnictvÃ­ tokenÅ¯, prompt cache, sÃ©mantickÃ© vyhledÃ¡vÃ¡nÃ­ kÃ³du, model routing a dokumentaÄnÃ­ pipeline.",
  "status": "active",
  "port": null,
  "tech": [
    "python",
    "sqlite",
    "numpy",
    "ollama",
    "anthropic-api"
  ],
  "access": {
    "local": "http://localhost:8080?project=ai",
    "lan": "http://192.168.0.101:8080?project=ai"
  },
  "modules": [
    {
      "id": "token_tracker",
      "name": "Token Tracker",
      "file": "_meta/token_tracker.py",
      "purpose": "SQLite ÃºÄetnictvÃ­ API volÃ¡nÃ­, deduplicnÃ­ prompt cache a automatickÃ© model routing.",
      "status": "stable",
      "public_methods": [
        {
          "name": "call_api",
          "params": "project: str, operation: str, model: str = 'auto', messages: list, system: str = ''",
          "returns": "str",
          "description": "JednotnÃ© rozhranÃ­ pro API volÃ¡nÃ­ s automatickÃ½m routingem, cache lookup, logovÃ¡nÃ­m a deduplicÃ­."
        },
        {
          "name": "agent log",
          "params": "--project X --operation op --model sonnet --in 5000 --out 1200",
          "returns": "None",
          "description": "RuÄnÃ­ zÃ¡znam API volÃ¡nÃ­ pro Claude Code sessions."
        },
        {
          "name": "agent billing",
          "params": "--today|--week|--month|--top|--project X|--model M",
          "returns": "str (tabulka)",
          "description": "PÅ™ehled nÃ¡kladÅ¯ na API volÃ¡nÃ­. Podpora filtrovÃ¡nÃ­ a agregace."
        },
        {
          "name": "agent cache",
          "params": "--stats|--list|--clear|--clear --all",
          "returns": "str (vÃ½pis)",
          "description": "SprÃ¡va prompt cache: statistiky, seznam, vymazÃ¡nÃ­."
        },
        {
          "name": "agent route",
          "params": "--show|--test OPERACE",
          "returns": "str (tabulka)",
          "description": "ZobrazenÃ­ a testovÃ¡nÃ­ model routing tabulky."
        }
      ],
      "dependencies": [],
      "notes": "DatabÃ¡ze: ~/.ai-agent/tokens.db. DostupnÃ© pÅ™es CLI ~/bin/agent. Model routing rozhoduje mezi Ollama (local) a Claude (cloud)."
    },
    {
      "id": "chroma_indexer",
      "name": "SÃ©mantickÃ½ vyhledÃ¡vaÄ",
      "file": "_meta/chroma_indexer.py",
      "purpose": "IndexovÃ¡nÃ­ a vyhledÃ¡vÃ¡nÃ­ kÃ³du pomocÃ­ vektorovÃ½ch embeddingÅ¯ (nomic-embed-text pÅ™es Ollama).",
      "status": "stable",
      "public_methods": [
        {
          "name": "agent index",
          "params": "[--project NAME|--diff|--force|--docs]",
          "returns": "None",
          "description": "IndexovÃ¡nÃ­ workspace Äi jednoho projektu. Strategie: per-definition pro Python, per-sekci pro Markdown."
        },
        {
          "name": "agent search",
          "params": "\"dotaz\" [--project X|--top N|--scope docs]",
          "returns": "list[SearchResult]",
          "description": "SÃ©mantickÃ© vyhledÃ¡vÃ¡nÃ­ kÃ³du a dokumentace. VracÃ­ relevance skÃ³re (0â€“1)."
        }
      ],
      "dependencies": [
        "token_tracker (pro Ollama API)"
      ],
      "notes": "DatabÃ¡ze: ~/.ai-agent/code_index.db (SQLite BLOB + numpy cosine similarity). KompatibilnÃ­ s Python 3.14 (alternativa k chromadb). Chunking: 60 Å™Ã¡dkÅ¯ s overlap=10 pro ostatnÃ­ typy souborÅ¯."
    },
    {
      "id": "docs_pipeline",
      "name": "Docs Pipeline",
      "file": "docs/build.py",
      "purpose": "JSON â†’ HTML renderer (Jinja2). AI generuje JSON, build.py renderuje statickÃ© HTML bez ÃºÄasti AI.",
      "status": "stable",
      "public_methods": [
        {
          "name": "build.py",
          "params": "[--project NAME|--check|--force|--output FILE]",
          "returns": "HTML file",
          "description": "Transformace docs/data/{projekt}.json â†’ docs/output/{projekt}.html. Hash cache pro inkrementÃ¡lnÃ­ buildy."
        }
      ],
      "dependencies": [
        "jinja2"
      ],
      "notes": "Å ablona: docs/templates/project.html.j2. SchÃ©ma: docs/schema/doc_schema.json. KlÃ­Ä pro seznamy je 'entries' (nikoli 'items' â€” conflict s Jinja2)."
    },
    {
      "id": "model_router",
      "name": "Model Routing",
      "file": "_meta/token_tracker.py (ROUTING_RULES)",
      "purpose": "AutomatickÃ© rozhodnutÃ­: kterou LLM pouÅ¾Ã­t pro danou operaci (local Ollama vs cloud Claude).",
      "status": "stable",
      "public_methods": [
        {
          "name": "route_model",
          "params": "operation: str, model: str = 'auto'",
          "returns": "str (endpoint URL)",
          "description": "VrÃ¡tÃ­ konkrÃ©tnÃ­ model dle ROUTING_RULES tabulky."
        }
      ],
      "dependencies": [],
      "notes": "Tabulka: doc_updateâ†’local, boilerplateâ†’local, code_reviewâ†’claude-sonnet, architectureâ†’claude-opus. MÄ›nÃ­ se pÅ™epÃ­nÃ¡nÃ­m LOCAL_MODEL v kÃ³du."
    }
  ],
  "sections": [
    {
      "id": "prehled",
      "title": "PÅ™ehled",
      "icon": "ğŸ“š",
      "blocks": [
        {
          "type": "text",
          "text": "AI Dev Agent Stack je integrovanÃ¡ sada nÃ¡strojÅ¯ pro optimalizaci prÃ¡ce s AI v monorepo workspace. Automatizuje ÃºÄetnictvÃ­ tokenÅ¯ (a jejich nÃ¡kladÅ¯), deduplicnÃ­ cacheovÃ¡nÃ­ promptÅ¯, sÃ©mantickÃ© vyhledÃ¡vÃ¡nÃ­ kÃ³du a inteligentnÃ­ model routing (automatickÃ½ vÃ½bÄ›r mezi lokÃ¡lnÃ­m Ollama a cloudovÃ½m Claude)."
        },
        {
          "type": "text",
          "text": "VÅ¡echny nÃ¡stroje jsou centrÃ¡lnÄ› pÅ™Ã­stupnÃ© pÅ™es CLI <code>~/bin/agent</code> a Python API <code>call_api()</code>. Stavy se uklÃ¡dajÃ­ do SQLite databÃ¡zÃ­ v <code>~/.ai-agent/</code>."
        },
        {
          "type": "heading",
          "text": "4 hlavnÃ­ pilÃ­Å™e"
        },
        {
          "type": "table",
          "headers": [
            "PilÃ­Å™",
            "Modul",
            "ÃšÄel"
          ],
          "rows": [
            [
              "<span class=\"badge badge-green\">ğŸ’° Finance</span>",
              "Token Tracker",
              "SledovÃ¡nÃ­ API nÃ¡kladÅ¯ â€” kolik stojÃ­ kaÅ¾dÃ© volÃ¡nÃ­ (input/output tokeny), model, projekt."
            ],
            [
              "<span class=\"badge badge-yellow\">âš¡ VÃ½kon</span>",
              "Prompt Cache",
              "ZnovupouÅ¾itÃ­ identickÃ½ch promptÅ¯ â€” uspoÅ™it tokeny a penÃ­ze (12.5â€“50% Ãºspora)."
            ],
            [
              "<span class=\"badge badge-blue\">ğŸ” PÅ™esnost</span>",
              "SÃ©mantickÃ© vyhledÃ¡vÃ¡nÃ­",
              "NalezenÃ­ relevantnÃ­ho kÃ³du z pÅ™irozenÃ©ho jazyka â€” bez BFS Äi fuzzy matchingu."
            ],
            [
              "<span class=\"badge badge-purple\">ğŸ§  Inteligence</span>",
              "Model Routing",
              "AutomatickÃ© rozhodnutÃ­: local LLM pro rychlÃ© Ãºlohy vs cloud Claude pro komplexnÃ­ analÃ½zu."
            ]
          ]
        }
      ]
    },
    {
      "id": "slovnik",
      "title": "SlovnÃ­k pojmÅ¯ (pro AI newcomery)",
      "icon": "ğŸ“–",
      "blocks": [
        {
          "type": "heading",
          "text": "Token â€” Co je to?"
        },
        {
          "type": "card",
          "variant": "info",
          "title": "ğŸ”¤ Token = MalÃ¡ jednotka textu",
          "text": "Claude a ostatnÃ­ LLM modely nepracujÃ­ pÅ™Ã­mo s textem â€” rozdÄ›lÃ­ ho na malÃ© kusy zvanÃ© <strong>tokeny</strong>. Jeden token je zhruba 4 znaky anglickÃ©ho textu.",
          "entries": [
            "<strong>PÅ™Ã­klad:</strong> Slovo 'hello' = ~1 token, vÄ›ta 'Hello, how are you?' = ~6 tokenÅ¯",
            "<strong>ÃšÄel:</strong> JednotnÃ¡ jednotka pro mÄ›Å™enÃ­ dÃ©lky promptu a vÃ½stupÅ¯",
            "<strong>Cena:</strong> KaÅ¾dÃ½ input token stojÃ­ penÃ­ze (pÅ™i cloudovÃ½ch LLM). Output token stojÃ­ vÃ­ce (je nÃ¡roÄnÄ›jÅ¡Ã­)"
          ]
        },
        {
          "type": "text",
          "text": "Proto Stack sleduje input vs output tokeny â€” aby vÄ›dÄ›l, co drahÃ©ho dÄ›lÃ¡Å¡."
        },
        {
          "type": "heading",
          "text": "Embedding â€” Co je to?"
        },
        {
          "type": "card",
          "variant": "info",
          "title": "ğŸ§² Embedding = Vektor reprezentace textu",
          "text": "Embedding je seznam ÄÃ­sel (vektor), kterÃ½ reprezentuje <strong>smysl</strong> textu â€” ne jeho exaktnÃ­ slova. Dva texty s podobnÃ½m smyslem majÃ­ blÃ­zkÃ© embeddingy.",
          "entries": [
            "<strong>PÅ™Ã­klad:</strong> 'psÃ­ zvÃ­Å™e' a 'pes' by mÄ›ly blÃ­zkÃ© embeddingy",
            "<strong>VÃ½poÄet:</strong> speciÃ¡lnÃ­ model (nomic-embed-text) zpracuje text a vrÃ¡tÃ­ vektor (seznam 768 ÄÃ­sel)",
            "<strong>PouÅ¾Ã­vÃ¡ se pro:</strong> sÃ©mantickÃ© vyhledÃ¡vÃ¡nÃ­ â€” co mÃ¡ AI najÃ­t v kÃ³du bez pÅ™esnÃ©ho matchovÃ¡nÃ­ slov"
          ]
        },
        {
          "type": "heading",
          "text": "Prompt Cache â€” Co je to?"
        },
        {
          "type": "card",
          "variant": "info",
          "title": "ğŸ’¾ Prompt Cache = UloÅ¾enÃ­ a znovupouÅ¾itÃ­ promptÅ¯",
          "text": "Pokud poÅ¡leÅ¡ Claude <strong>stejnÃ½ prompt dvakrÃ¡t za sebou</strong>, druhÃ½ request je vÃ½raznÄ› levnÄ›jÅ¡Ã­ (12.5â€“50% uÅ¡etÅ™eno). Cache to dÄ›lÃ¡ automaticky â€” nedÃ¡Å¡ si pozor.",
          "entries": [
            "<strong>PÅ™Ã­pad:</strong> 'Vygeneruj dokumentaci' â€” pokud se context (codebase) nemÄ›nÃ­, druhÃ© volÃ¡nÃ­ je levnÄ›jÅ¡Ã­",
            "<strong>TTL:</strong> ÄŒÃ­m dÃ©le jsou data stabilnÃ­, tÃ­m delÅ¡Ã­ cache TTL (doc_update = 24h, code_review = 0h)",
            "<strong>VÃ½hoda:</strong> UÅ¡etÅ™it stovky dolarÅ¯ za rok na vÄ›tÅ¡Ã­ch projektech"
          ]
        },
        {
          "type": "heading",
          "text": "Model Routing â€” Co je to?"
        },
        {
          "type": "card",
          "variant": "info",
          "title": "ğŸ›£ï¸ Model Routing = InteligentnÃ­ vÃ½bÄ›r LLM",
          "text": "Ne vÅ¡echny Ãºlohy potÅ™ebujÃ­ nejdraÅ¾Å¡Ã­ model. Stack mÃ¡ <strong>tabulku rozhodnutÃ­</strong>: pro doc_update pouÅ¾ij levnÃ© lokÃ¡lnÃ­ Ollama, pro architecture analysis pouÅ¾ij vÃ½konnÃ½ Claude Opus.",
          "entries": [
            "<strong>Local (Ollama):</strong> Zdarma, bÄ›Å¾Ã­ na tvÃ©m stroji, rychlÃ½, ale mÃ©nÄ› inteligentnÃ­",
            "<strong>Cloud (Claude):</strong> PlacenÃ½, ale velmi chytrÃ½ â€” vÃ­ce penÄ›z za komplexnÃ­ analÃ½zu",
            "<strong>Strategie:</strong> AutomatickÃ© rozhodnutÃ­ â€” Ãºspora penÄ›z a Äasu"
          ]
        },
        {
          "type": "heading",
          "text": "Prompt Deduplication â€” Co je to?"
        },
        {
          "type": "card",
          "variant": "info",
          "title": "ğŸ”€ Dedup = Detekce a znovupouÅ¾itÃ­ identickÃ½ch promptÅ¯",
          "text": "Pokud AI agent dostane poÅ¾adavek, kterÃ½ <strong>uÅ¾ dÅ™Ã­v dostal</strong> (stejnÃ½ prompt, stejnÃ½ context), tak vrÃ¡tÃ­ uloÅ¾enou odpovÄ›Ä mÃ­sto novÃ©ho API volÃ¡nÃ­.",
          "entries": [
            "<strong>Jak to funguje:</strong> VypoÄÃ­tej hash promptu â†’ podÃ­vej se do cache â†’ pokud je tam a nenÃ­ expirovanÃ½ â†’ vraÅ¥ starou odpovÄ›Ä",
            "<strong>Ãšspora:</strong> Nula nÃ¡kladÅ¯ na API (jen databÃ¡zovÃ½ lookup)",
            "<strong>BezpeÄnost:</strong> Pokud je context citlivÃ½, nastav TTL = 0 (vypni cache)"
          ]
        }
      ]
    },
    {
      "id": "architektura",
      "title": "Architektura",
      "icon": "ğŸ—‚ï¸",
      "blocks": [
        {
          "type": "text",
          "text": "Stack tvoÅ™Ã­ nÄ›kolik vrstev, kterÃ© spolu komunikujÃ­ pÅ™es CLI a Python API:"
        },
        {
          "type": "code",
          "lang": "text",
          "text": "â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                    USER INTERFACE                           â”‚\nâ”‚  ~/bin/agent (CLI router)  +  Python: call_api()            â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                   â”‚                              â”‚\n       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n       â”‚                       â”‚        â”‚                  â”‚\n   â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”   â”Œâ–¼â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”\n   â”‚Financialsâ”‚          â”‚Caching â”‚   â”‚Semantic â”‚     â”‚Docs     â”‚\n   â”‚---------â”‚          â”‚--------â”‚   â”‚Search   â”‚     â”‚Pipeline â”‚\n   â”‚Logging   â”‚          â”‚Dedup   â”‚   â”‚------   â”‚     â”‚------   â”‚\n   â”‚Billing   â”‚          â”‚TTL     â”‚   â”‚Index    â”‚     â”‚JSONâ†’HTMLâ”‚\n   â”‚Routing   â”‚          â”‚        â”‚   â”‚Query    â”‚     â”‚Jinja2   â”‚\n   â””â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”¬â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜\n     â”‚ API calls saved        â”‚ prompt hashes  â”‚ embeddings â”‚ static\n     â”‚                        â”‚                â”‚            â”‚ files\n     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                  â”‚\n         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n         â”‚   ~/.ai-agent/                   â”‚\n         â”‚  â”œâ”€ tokens.db     (SQLite)       â”‚\n         â”‚  â”‚  â””â”€ API calls + cache         â”‚\n         â”‚  â””â”€ code_index.db (SQLite)       â”‚\n         â”‚     â””â”€ embeddingy + source code  â”‚\n         â”‚                                  â”‚\n         â”‚  Ollama (local)                  â”‚\n         â”‚  â”œâ”€ nomic-embed-text             â”‚\n         â”‚  â””â”€ qwen2.5-coder:14b            â”‚\n         â”‚                                  â”‚\n         â”‚  External                        â”‚\n         â”‚  â””â”€ Anthropic API (Claude)       â”‚\n         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
        },
        {
          "type": "heading",
          "text": "Jak pracuje typickÃ© volÃ¡nÃ­"
        },
        {
          "type": "list",
          "ordered": true,
          "entries": [
            "<strong>1. User zavolÃ¡:</strong> <code>call_api(project='backup-dashboard', operation='doc_update', model='auto', messages=[...])</code>",
            "<strong>2. Routing:</strong> Stack se podÃ­vÃ¡ do ROUTING_RULES â€” 'doc_update' â†’ local (Ollama)",
            "<strong>3. Cache lookup:</strong> VypoÄÃ­tej hash promptu â†’ podÃ­vej se do ~/.ai-agent/tokens.db",
            "<strong>4. Hit/Miss?</strong> Pokud je v cache a nenÃ­ expirovanÃ½ â†’ vraÅ¥ starou odpovÄ›Ä (return). Pokud ne â†’ pokraÄuj",
            "<strong>5. API volÃ¡nÃ­:</strong> PoÅ¡li prompt lokÃ¡lnÃ­mu Ollama (free) nebo cloud Claude (placeno)",
            "<strong>6. Logging:</strong> UloÅ¾ do tokens.db: input/output tokeny, cena, model, projekt, operace, TTL expiraci",
            "<strong>7. Cache store:</strong> UloÅ¾ hash+odpovÄ›Ä do cache pro pÅ™Ã­Å¡tÃ­ volÃ¡nÃ­",
            "<strong>8. Return:</strong> VraÅ¥ text uÅ¾ivateli"
          ]
        }
      ]
    },
    {
      "id": "token-tracker",
      "title": "Token Tracker â€” ÃšÄetnictvÃ­ API",
      "icon": "ğŸ’°",
      "blocks": [
        {
          "type": "text",
          "text": "Token Tracker sleduje <strong>kaÅ¾dÃ© API volÃ¡nÃ­</strong> â€” kolik tokenÅ¯, jakÃ½ model, jakÃ© nÃ¡klady, k jakÃ©mu projektu. VÅ¡echno se uklÃ¡dÃ¡ do SQLite databÃ¡ze <code>~/.ai-agent/tokens.db</code>."
        },
        {
          "type": "heading",
          "text": "Ceny modelÅ¯ (Anthropic)"
        },
        {
          "type": "table",
          "headers": [
            "Model",
            "Input cena",
            "Output cena",
            "PouÅ¾itÃ­"
          ],
          "rows": [
            [
              "<code>claude-opus-4-6</code>",
              "$15 / M tokenÅ¯",
              "$75 / M tokenÅ¯",
              "NejlepÅ¡Ã­ â€” komplexnÃ­ analÃ½za (architecture)"
            ],
            [
              "<code>claude-sonnet-4-6</code>",
              "$3 / M tokenÅ¯",
              "$15 / M tokenÅ¯",
              "DobrÃ½ pomÄ›r ceny/vÃ½konu â€” code review, debug"
            ],
            [
              "<code>claude-haiku-4-5</code>",
              "$0.80 / M tokenÅ¯",
              "$4 / M tokenÅ¯",
              "NejlevnÄ›jÅ¡Ã­ â€” jednoduchÃ© Ãºlohy"
            ],
            [
              "<strong>Ollama (local)</strong>",
              "$0",
              "$0",
              "Zdarma â€” bÄ›Å¾nÃ© Ãºlohy (doc_update, boilerplate)"
            ]
          ]
        },
        {
          "type": "heading",
          "text": "CLI pÅ™Ã­kazy"
        },
        {
          "type": "card",
          "variant": "info",
          "title": "ğŸ’¾ RuÄnÃ­ zÃ¡znam",
          "code": "# Pro Claude Code sessions (netrackuje se automaticky)\nagent log --project backup-dashboard --operation doc_update \\\n  --model sonnet --in 5000 --out 1200 --notes \"Aktualizace dokumentace\""
        },
        {
          "type": "card",
          "variant": "info",
          "title": "ğŸ“Š PÅ™ehledy",
          "code": "agent billing                # vÅ¡e za vÅ¡echny doby\nagent billing --today        # jen dnes\nagent billing --week         # poslednÃ­ch 7 dnÃ­\nagent billing --month        # poslednÃ­ch 30 dnÃ­\nagent billing --project backup-dashboard  # filtr\nagent billing --model sonnet # filtr modelu\nagent billing --top          # top 10 nejdraÅ¾Å¡Ã­ch operacÃ­"
        },
        {
          "type": "heading",
          "text": "PÅ™Ã­klady nÃ¡kladÅ¯"
        },
        {
          "type": "list",
          "entries": [
            "<strong>JednoduchÃ©:</strong> 2000 input + 500 output tokenÅ¯ na Haiku = ~$0.004 (ÄtyÅ™i setiny centa)",
            "<strong>StÅ™ednÃ­:</strong> 10k input + 3k output na Sonnet = ~$0.06 (Å¡est setin centa)",
            "<strong>KomplexnÃ­:</strong> 20k input + 8k output na Opus = ~$0.75 (75 centÅ¯ za analysis)"
          ]
        }
      ]
    },
    {
      "id": "prompt-cache",
      "title": "Prompt Cache & Deduplication",
      "icon": "âš¡",
      "blocks": [
        {
          "type": "text",
          "text": "Prompt cache je mechanismus pro uÅ¡etÅ™enÃ­ nÃ¡kladÅ¯: pokud poÅ¡leÅ¡ Claude <strong>stejnÃ½ prompt vÃ­cekrÃ¡t</strong>, druhÃ½ a nÃ¡sledujÃ­cÃ­ requesty jsou <strong>50% levnÄ›jÅ¡Ã­</strong> na input tokenech."
        },
        {
          "type": "heading",
          "text": "Jak funguje"
        },
        {
          "type": "list",
          "ordered": true,
          "entries": [
            "VypoÄÃ­tej MD5 hash promptu (message.content + system)",
            "Vyhledej v ~/.ai-agent/tokens.db: <code>SELECT * FROM cache WHERE hash=?</code>",
            "Je tam? A nenÃ­ expirovanÃ½ (TTL)? â†’ <strong>VraÅ¥ uloÅ¾enou odpovÄ›Ä (0 API volÃ¡nÃ­)</strong>",
            "NenÃ­ tam nebo je expirovanÃ½? â†’ PoÅ¡li do Claude/Ollama, uloÅ¾ odpovÄ›Ä s TTL expiracÃ­"
          ]
        },
        {
          "type": "heading",
          "text": "TTL (Time To Live) tabulka"
        },
        {
          "type": "table",
          "headers": [
            "Operace",
            "TTL",
            "DÅ¯vod"
          ],
          "rows": [
            [
              "<code>doc_update</code>",
              "24h",
              "Dokumentace se mÄ›nÃ­ zÅ™Ã­dka"
            ],
            [
              "<code>boilerplate</code>",
              "48h",
              "Å ablony jsou stabilnÃ­"
            ],
            [
              "<code>info_sync</code>",
              "12h",
              "Git info se zmÄ›nÃ­ bÄ›hem dne"
            ],
            [
              "<code>code_review</code>",
              "0 (vypnuto)",
              "VÅ¾dy chceme Äerstvou analÃ½zu"
            ],
            [
              "<code>architecture</code>",
              "0 (vypnuto)",
              "Architektura se mÄ›nÃ­ â€” nechceme starÃ¡ data"
            ]
          ]
        },
        {
          "type": "heading",
          "text": "CLI pÅ™Ã­kazy"
        },
        {
          "type": "card",
          "variant": "info",
          "title": "Cache statistiky",
          "code": "agent cache --stats\n# VÃ½stup:\n# ğŸ“Š Cache Stats\n# Cached entries: 127\n# Size on disk: 4.2 MB\n# TTL distribution:\n#   24h: 45\n#   12h: 82"
        },
        {
          "type": "card",
          "variant": "info",
          "title": "Cache management",
          "code": "agent cache --list              # seznam vÅ¡ech cached entries\nagent cache --clear             # smazat expirovanÃ©\nagent cache --clear --all       # smazat vÅ¡e"
        },
        {
          "type": "heading",
          "text": "PraktickÃ½ pÅ™Ã­pad"
        },
        {
          "type": "text",
          "text": "PÅ™edstav si, Å¾e generujeÅ¡ dokumentaci pro projekt. First call: 10k input tokenÅ¯ = $0.08 (Sonnet). Second call (stejnÃ½ prompt, stejnÃ½ context): <strong>5k tokenÅ¯</strong> (cache hit) = <strong>$0.04</strong>. Ãšspora: 50% â€” a stane se to automaticky."
        }
      ]
    },
    {
      "id": "semantic-search",
      "title": "SÃ©mantickÃ© vyhledÃ¡vÃ¡nÃ­ kÃ³du",
      "icon": "ğŸ”",
      "blocks": [
        {
          "type": "text",
          "text": "SÃ©mantickÃ© vyhledÃ¡vÃ¡nÃ­ pouÅ¾Ã­vÃ¡ <strong>embeddingy</strong> (vektory) k nalezenÃ­ relevantnÃ­ho kÃ³du. Na rozdÃ­l od keyword search ('grep') to rozumÃ­ <strong>smyslu</strong> kÃ³du."
        },
        {
          "type": "heading",
          "text": "TypickÃ© scÃ©nÃ¡Å™e"
        },
        {
          "type": "list",
          "entries": [
            "User: <em>'Kde mÃ¡m logiku pro retry'</em> â†’ hledÃ¡ \"retry\" ve vÅ¡ech .py souborech â†’ nalezne tÅ™Ã­du, kterÃ¡ to implementuje",
            "User: <em>'Co se stane, kdyÅ¾ se disk zapojÃ­'</em> â†’ hledÃ¡ semanticky: mount, eject, plug â†’ vrÃ¡tÃ­ relevantnÃ­ handler",
            "User: <em>'Jak se synchronizujÃ­ snapshoty'</em> â†’ hledÃ¡ btrfs send, sync, snapshot â†’ vrÃ¡tÃ­ sprÃ¡vnÃ½ modul"
          ]
        },
        {
          "type": "heading",
          "text": "CLI pÅ™Ã­kazy"
        },
        {
          "type": "card",
          "variant": "info",
          "title": "IndexovÃ¡nÃ­",
          "code": "agent index                         # indexuj celÃ½ workspace\nagent index --project backup-dashboard  # jen jeden projekt\nagent index --diff                  # jen git-changed soubory\nagent index --force                 # ignoruj cache, reindex vÅ¡e\nagent index --docs                  # zahrnout i .md soubory"
        },
        {
          "type": "card",
          "variant": "info",
          "title": "HledÃ¡nÃ­",
          "code": "agent search \"retry logika\"\nagent search \"zÃ¡loha borg\" --project backup-dashboard\nagent search \"WebSocket\" --top 10\nagent search \"co projekt dÄ›lÃ¡\" --scope docs"
        },
        {
          "type": "heading",
          "text": "Jak funguje internally"
        },
        {
          "type": "list",
          "ordered": true,
          "entries": [
            "<strong>IndexovÃ¡nÃ­:</strong> ÄŒti .py/.md soubory â†’ chunking (per-function, per-section) â†’ nomic-embed-text vrÃ¡tÃ­ vektory â†’ uloÅ¾ do ~/.ai-agent/code_index.db",
            "<strong>VyhledÃ¡vÃ¡nÃ­:</strong> User zadÃ¡ dotaz â†’ nomic-embed-text â†’ query vektor â†’ cosine similarity proti vÅ¡em stored embeddingÅ¯m â†’ top-N vÃ½sledky",
            "<strong>SkÃ³rovÃ¡nÃ­:</strong> 0.75+ = zelenÃ¡ (vÃ½bornÄ› relevantnÃ­), 0.55â€“0.75 = Å¾lutÃ¡ (relevantnÃ­), &lt;0.55 = Å¡edÃ¡ (slabÄ›)"
          ]
        },
        {
          "type": "card",
          "variant": "warning",
          "title": "âš ï¸ Chunking strategie",
          "text": "Jak se kÃ³d rozdÄ›luje na vyhledÃ¡vatelnÃ© kusy:",
          "entries": [
            "<strong>Python (.py):</strong> Per definition â€” kaÅ¾dÃ¡ <code>def</code> nebo <code>class</code> je jeden chunk",
            "<strong>Markdown (.md):</strong> Per section â€” kaÅ¾dÃ½ nadpis (#, ##) je jeden chunk",
            "<strong>OstatnÃ­:</strong> Sliding window â€” 60 Å™Ã¡dkÅ¯, overlap=10"
          ]
        }
      ]
    },
    {
      "id": "model-routing",
      "title": "Model Routing â€” AutomatickÃ½ vÃ½bÄ›r LLM",
      "icon": "ğŸ§ ",
      "blocks": [
        {
          "type": "text",
          "text": "Model Routing je <strong>rozhodovacÃ­ tabulka</strong>, kterÃ¡ Å™Ã­kÃ¡: pro tuhle Ãºlohu pouÅ¾ij tohle. CÃ­l: <strong>uÅ¡etÅ™it penÃ­ze bez ztrÃ¡ty kvality</strong>."
        },
        {
          "type": "heading",
          "text": "Routing tabulka"
        },
        {
          "type": "table",
          "headers": [
            "Operace",
            "Target",
            "Model",
            "DÅ¯vod"
          ],
          "rows": [
            [
              "<code>doc_update</code>",
              "local",
              "qwen2.5-coder:14b",
              "GenerovÃ¡nÃ­ doc â€” strojÃ©, Ollama zvlÃ¡dÃ¡"
            ],
            [
              "<code>boilerplate</code>",
              "local",
              "qwen2.5-coder:14b",
              "Å ablony boilerplate â€” Ollama ma v 'pamÄ›ti'"
            ],
            [
              "<code>info_sync</code>",
              "local",
              "qwen2.5-coder:14b",
              "Sync informacÃ­ z git â€” lokÃ¡lnÃ­ operace"
            ],
            [
              "<code>code_review</code>",
              "cloud",
              "claude-sonnet-4-6",
              "DetailnÃ­ review â€” potÅ™ebujeme chytrÃ½ model"
            ],
            [
              "<code>architecture</code>",
              "cloud",
              "claude-opus-4-6",
              "AnalÃ½za architektury â€” nejnÃ¡roÄnÄ›jÅ¡Ã­"
            ],
            [
              "<code>debug_complex</code>",
              "cloud",
              "claude-sonnet-4-6",
              "Å˜eÅ¡enÃ­ sloÅ¾itÃ½ch bugÅ¯ â€” Sonnet"
            ],
            [
              "<code>_default</code>",
              "cloud",
              "claude-sonnet-4-6",
              "Cokoliv jinÃ©ho â€” safe choice"
            ]
          ]
        },
        {
          "type": "heading",
          "text": "Python API"
        },
        {
          "type": "code",
          "lang": "python",
          "text": "from _meta.token_tracker import call_api\n\n# UÅ¾ivatel Å™ekne: \"Vygeneruj dokumentaci\"\nresponse = call_api(\n    project='backup-dashboard',\n    operation='doc_update',\n    model='auto',  # routing rozhodne za tebe\n    messages=[{'role': 'user', 'content': 'Vygeneruj...'}],\n)\n# V pozadÃ­: routing â†’ \"doc_update\" â†’ local â†’ Ollama â†’ zdarma"
        },
        {
          "type": "heading",
          "text": "CLI pÅ™Ã­kazy"
        },
        {
          "type": "card",
          "variant": "info",
          "title": "Zobrazit routing tabulku",
          "code": "agent route --show\n# VÃ½stup: tabelka s aktuÃ¡lnÃ½mi pravidly"
        },
        {
          "type": "card",
          "variant": "info",
          "title": "Otestovat routing",
          "code": "agent route --test doc_update\n# VÃ½stup: 'doc_update' â†’ local, model=qwen2.5-coder:14b"
        },
        {
          "type": "heading",
          "text": "Jak se mÄ›nÃ­"
        },
        {
          "type": "list",
          "entries": [
            "Edituj <code>_meta/token_tracker.py</code>, sekce <code>ROUTING_RULES</code>",
            "ZmÄ›Åˆ LOCAL_MODEL na nÄ›co jinÃ©ho (pokud mÃ¡Å¡ Ollama)",
            "Pushni do gitu"
          ]
        }
      ]
    },
    {
      "id": "docs-pipeline",
      "title": "Docs Pipeline â€” JSON â†’ HTML",
      "icon": "ğŸ“",
      "blocks": [
        {
          "type": "text",
          "text": "Docs Pipeline je <strong>dvoustupÅˆovÃ½ proces</strong>: (1) AI generuje JSON strukturu, (2) build.py renderuje statickÃ© HTML bez ÃºÄasti AI."
        },
        {
          "type": "heading",
          "text": "Workflow"
        },
        {
          "type": "list",
          "ordered": true,
          "entries": [
            "<strong>AI vygeneruje:</strong> docs/data/PROJECT.json (strukturovanÃ¡ dokumentace)",
            "<strong>Validace:</strong> build.py ovÄ›Å™Ã­ JSON proti doc_schema.json",
            "<strong>Rendering:</strong> Jinja2 Å¡ablona docs/templates/project.html.j2 renderuje HTML",
            "<strong>Output:</strong> StatickÃ½ soubor docs/output/PROJECT.html",
            "<strong>Serve:</strong> docserver.py na portu 8080 zobrazuje HTML"
          ]
        },
        {
          "type": "heading",
          "text": "JSON Schema"
        },
        {
          "type": "card",
          "variant": "info",
          "title": "Struktura dokumentu",
          "text": "KaÅ¾dÃ½ docs/data/{projekt}.json mÃ¡ tyto fieldy:",
          "entries": [
            "<code>project</code> â€” ID projektu",
            "<code>display_name</code> â€” zobrazovanÃ½ nÃ¡zev",
            "<code>updated</code> â€” datum poslednÃ­ aktualizace (YYYY-MM-DD)",
            "<code>status</code> â€” active/wip/planned/archived",
            "<code>modules</code> â€” seznam kÃ³dovÃ½ch modulÅ¯ (tÅ™Ã­dy, funkce, CLI commands)",
            "<code>sections</code> â€” seznam dokumentaÄnÃ­ch sekcÃ­ (pÅ™ehled, architektura, FAQ, ...)"
          ]
        },
        {
          "type": "heading",
          "text": "CLI pÅ™Ã­kazy"
        },
        {
          "type": "code",
          "lang": "bash",
          "text": "python build.py                              # build vÅ¡echny projekty\npython build.py --project ai                 # jen 'ai' projekt\npython build.py --project ai --force         # ignoruj cache\npython build.py --check                      # jen validace JSON\npython build.py --project ai --output /tmp/ai.html  # custom output"
        },
        {
          "type": "heading",
          "text": "POZOR: klÃ­Ä je 'entries', ne 'items'"
        },
        {
          "type": "card",
          "variant": "danger",
          "title": "âš ï¸ Jinja2 conflict",
          "text": "V JSON seznamech <strong>MUSÃ</strong> bÃ½t klÃ­Ä <code>\"entries\"</code>, ne <code>\"items\"</code>. <code>items</code> je rezervovanÃ© slovo v Pythonu a zpÅ¯sobuje chybu v Jinja2.",
          "code": "// âœ— Å PATNÄš\n{\"type\": \"list\", \"items\": [\"item1\", \"item2\"]}\n\n// âœ“ SPRÃVNÄš\n{\"type\": \"list\", \"entries\": [\"item1\", \"item2\"]}"
        }
      ]
    },
    {
      "id": "use-cases",
      "title": "Use Cases â€” praktickÃ© pÅ™Ã­klady",
      "icon": "ğŸ’¡",
      "blocks": [
        {
          "type": "heading",
          "text": "Case 1: Dokumentace projektu"
        },
        {
          "type": "list",
          "ordered": true,
          "entries": [
            "AI vygeneruje docs/data/backup-dashboard.json",
            "<code>python build.py --project backup-dashboard</code>",
            "HTML se zobrazÃ­ na http://localhost:8080",
            "Cost tracking: 12k input + 4k output = ~$0.12 (Sonnet cache hit = jeÅ¡tÄ› levnÄ›jÅ¡Ã­)"
          ]
        },
        {
          "type": "heading",
          "text": "Case 2: Code Review automatizace"
        },
        {
          "type": "list",
          "ordered": true,
          "entries": [
            "NovÃ½ commit v gitu â†’ Git hook â†’ spustÃ­ 'agent search' + 'agent index --diff'",
            "Vyhledej relevantnÃ­ kÃ³d pomocÃ­ semantic search",
            "PoÅ¡li do Claude Sonnet pro review (model routing: code_review â†’ cloud)",
            "Cache hit: pokud je to stejnÃ½ typ review, druhÃ½ commit je 50% levnÄ›jÅ¡Ã­"
          ]
        },
        {
          "type": "heading",
          "text": "Case 3: Monitoring nÃ¡kladÅ¯"
        },
        {
          "type": "list",
          "ordered": true,
          "entries": [
            "KaÅ¾dÃ½ mÄ›sÃ­c spustit: <code>agent billing --month --top</code>",
            "VidÄ›t: kterÃ© operace stojÃ­ nejvÃ­ce (architektura? velkÃ½ context?)",
            "Optimalizovat: snÃ­Å¾it TTL cache pro levnÃ© operace, zvÃ½Å¡it pro drahÃ©"
          ]
        },
        {
          "type": "heading",
          "text": "Case 4: LokÃ¡lnÃ­ AI bez internetu"
        },
        {
          "type": "list",
          "ordered": true,
          "entries": [
            "MÃ¡Å¡ Ollama s qwen2.5-coder nainstalovanÃ½",
            "VÅ¡echny doc_update, boilerplate, info_sync bÄ›Å¾Ã­ <strong>lokÃ¡lnÄ› zdarma</strong>",
            "Pouze code_review a architecture jdou do cloudu (Claude)",
            "UÅ¡etÅ™Ã­Å¡: 70% nÃ¡kladÅ¯, protoÅ¾e 70% operacÃ­ je lokÃ¡lnÃ­ch"
          ]
        }
      ]
    },
    {
      "id": "faq",
      "title": "FAQ",
      "icon": "â“",
      "blocks": [
        {
          "type": "heading",
          "text": "Co je to Ollama?"
        },
        {
          "type": "text",
          "text": "Ollama je <strong>lokÃ¡lnÃ­ LLM runtime</strong> â€” server, kterÃ½ bÄ›Å¾Ã­ na tvÃ©m stroji a nabÃ­zÃ­ AI modely (qwen, llama, mistral, ...). V tomto stacku se pouÅ¾Ã­vÃ¡ pro levnÃ©/rychlÃ© operace."
        },
        {
          "type": "heading",
          "text": "Jak se zapnout Ollama?"
        },
        {
          "type": "code",
          "lang": "bash",
          "text": "# 1. StÃ¡hni Ollama (ollama.ai)\n# 2. SpusÅ¥ daemon\nollama serve\n\n# 3. V jinÃ©m terminÃ¡lÅ¯ stÃ¡hni modely\nollama pull qwen2.5-coder:14b\nollama pull nomic-embed-text\n\n# 4. Zkontroluj\ncurl -s http://localhost:11434/api/tags | python3 -m json.tool"
        },
        {
          "type": "heading",
          "text": "Kolik zaplatÃ­m za API?"
        },
        {
          "type": "text",
          "text": "ZÃ¡leÅ¾Ã­ na <strong>typu operace</strong>. Pokud vÅ¡echno bÄ›Å¾Ã­ na Ollama (local), zaplatÃ­Å¡ <strong>$0</strong>. Pokud pouÅ¾Ã­vÃ¡Å¡ Claude, zaplatÃ­Å¡ dle modelu: Haiku = levnÃ©, Opus = drahÃ©. Tracking: <code>agent billing</code>."
        },
        {
          "type": "heading",
          "text": "Co se stane, kdyÅ¾ internet selÅ¾e?"
        },
        {
          "type": "text",
          "text": "Operace routovanÃ© na local (doc_update, boilerplate) budou fungovat. Operace na cloud (code_review, architecture) selÅ¾ou s chybou. Alternativa: vÅ¡echno routuj na Ollama v ROUTING_RULES."
        },
        {
          "type": "heading",
          "text": "Jak smazat cache?"
        },
        {
          "type": "code",
          "lang": "bash",
          "text": "agent cache --clear        # smazat expirovanÃ©\nagent cache --clear --all  # smazat vÅ¡e (VAROVÃNÃ: ztratÃ­Å¡ Ãºsporu)"
        },
        {
          "type": "heading",
          "text": "Mohu manuÃ¡lnÄ› editovat JSON dokumenty?"
        },
        {
          "type": "text",
          "text": "Ano, ale musÃ­ to odpovÃ­dat doc_schema.json. AI je primÃ¡rnÃ­ zdroj (pÅ™esnÄ›jÅ¡Ã­), ale malÃ© opravy rukou jsou OK. Po editaci: <code>python build.py --project X --force</code>."
        }
      ]
    },
    {
      "id": "setup",
      "title": "Setup & Inicializace",
      "icon": "âš™ï¸",
      "blocks": [
        {
          "type": "heading",
          "text": "PovinnÃ©: Anthropic API klÃ­Ä"
        },
        {
          "type": "list",
          "ordered": true,
          "entries": [
            "Jdi na <code>console.anthropic.com</code>",
            "VytvoÅ™ API klÃ­Ä",
            "UloÅ¾ do <code>~/.anthropic-api-key</code> nebo env <code>ANTHROPIC_API_KEY</code>"
          ]
        },
        {
          "type": "heading",
          "text": "VolitelnÃ©: Ollama (pro lokÃ¡lnÃ­ LLM)"
        },
        {
          "type": "list",
          "ordered": true,
          "entries": [
            "StÃ¡hni <a href='https://ollama.ai'>Ollama</a> a spusÅ¥ daemon",
            "StÃ¡hni modely: <code>ollama pull qwen2.5-coder:14b nomic-embed-text</code>",
            "OvÄ›Å™: <code>curl -s http://localhost:11434/api/tags</code>"
          ]
        },
        {
          "type": "heading",
          "text": "Python balÃ­Äky"
        },
        {
          "type": "code",
          "lang": "bash",
          "text": "pip install -U anthropic jinja2 jsonschema numpy"
        },
        {
          "type": "heading",
          "text": "Inicializace"
        },
        {
          "type": "code",
          "lang": "bash",
          "text": "agent init\n# VytvoÅ™Ã­: ~/.ai-agent/\n#   â”œâ”€ tokens.db\n#   â””â”€ code_index.db"
        },
        {
          "type": "heading",
          "text": "SpuÅ¡tÄ›nÃ­ services"
        },
        {
          "type": "code",
          "lang": "bash",
          "text": "# docserver â€” port 8080\npython3 ~/projects/docs/docserver.py &\n\n# ovÄ›Å™\ncurl -s http://localhost:8080/api/projects | python3 -m json.tool"
        }
      ]
    },
    {
      "id": "reference",
      "title": "CLI Reference",
      "icon": "âŒ¨ï¸",
      "blocks": [
        {
          "type": "heading",
          "text": "Token Tracker"
        },
        {
          "type": "code",
          "lang": "bash",
          "text": "# RuÄnÃ­ zÃ¡znam\nagent log --project X --operation doc_update --model sonnet --in 5000 --out 1200\n\n# PÅ™ehledy\nagent billing [--today|--week|--month|--top|--project X|--model M]\n\n# Cache\nagent cache [--stats|--list|--clear|--clear --all]\n\n# Routing\nagent route [--show|--test OPERACE]"
        },
        {
          "type": "heading",
          "text": "Semantic Search"
        },
        {
          "type": "code",
          "lang": "bash",
          "text": "# IndexovÃ¡nÃ­\nagent index [--project NAME|--diff|--force|--docs]\n\n# HledÃ¡nÃ­\nagent search \"DOTAZ\" [--project X|--top N|--scope docs]"
        },
        {
          "type": "heading",
          "text": "Docs Pipeline"
        },
        {
          "type": "code",
          "lang": "bash",
          "text": "cd ~/projects/docs\npython build.py [--project X|--check|--force|--output FILE]"
        },
        {
          "type": "heading",
          "text": "Init"
        },
        {
          "type": "code",
          "lang": "bash",
          "text": "agent init  # vytvoÅ™Ã­ ~/.ai-agent/ + databÃ¡ze"
        }
      ]
    },
    {
      "id": "layers",
      "title": "VrstvitÃ¡ vysvÄ›tlenÃ­ (Beginner â†’ Advanced)",
      "icon": "ğŸ“š",
      "blocks": [
        {
          "type": "heading",
          "text": "Vrstva 1: Co to je (pro ÃºplnÃ©ho zaÄÃ¡teÄnÃ­ka)"
        },
        {
          "type": "text",
          "text": "MÃ¡Å¡ AI asistenta. PokaÅ¾dÃ©, kdyÅ¾ si s nÃ­m povÃ­dÃ¡Å¡, stojÃ­ to penÃ­ze â€” proto chceÅ¡ vÄ›dÄ›t, <strong>kolik penÄ›z jsi utratil</strong> a jak to <strong>zlevnit</strong>. AI Dev Agent Stack je takovÃ¡ ÃºÄetnÃ­, kterÃ¡ to za tebe dÄ›lÃ¡."
        },
        {
          "type": "heading",
          "text": "Vrstva 2: Jak se to pouÅ¾Ã­vÃ¡"
        },
        {
          "type": "text",
          "text": "MÃ­sto pÅ™Ã­mÃ©ho volÃ¡nÃ­ Claude API volÃ¡Å¡ <code>call_api()</code>. Ta funkce (1) vÃ­, kterÃ½ model pouÅ¾Ã­t, (2) sleduje vÃ½daje, (3) znovupouÅ¾Ã­vÃ¡ starÃ© odpovÄ›di, (4) indexuje tvÅ¯j kÃ³d pro lepÅ¡Ã­ hledÃ¡nÃ­. VÅ¡echno automaticky."
        },
        {
          "type": "heading",
          "text": "Vrstva 3: InternÃ­ mechanismy"
        },
        {
          "type": "text",
          "text": "InternÄ› Stack pouÅ¾Ã­vÃ¡ SQLite databÃ¡ze pro logovÃ¡nÃ­, deduplicnÃ­ cache s TTL, vektorovÃ© embeddingy pro sÃ©mantickÃ© vyhledÃ¡vÃ¡nÃ­ a routing tabulku pro model selection. VÅ¡e je deterministickÃ© a auditovatelnÃ©."
        },
        {
          "type": "heading",
          "text": "Vrstva 4: Optimalizace a Ğ°Ñ€Ñ…Ñ–Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°"
        },
        {
          "type": "text",
          "text": "MÅ¯Å¾eÅ¡ optimalizovat: zvÃ½Å¡it TTL pro operace, kterÃ© se opakujÃ­ (niÅ¾Å¡Ã­ nÃ¡klady); zmÄ›nit routing pro pÅ™idÃ¡nÃ­ novÃ½ch modelÅ¯; vytvoÅ™it vlastnÃ­ cache strategie dle domÃ©ny."
        }
      ]
    },
    {
      "id": "troubleshooting",
      "title": "Å˜eÅ¡enÃ­ problÃ©mÅ¯",
      "icon": "ğŸ”§",
      "blocks": [
        {
          "type": "heading",
          "text": "Chyba: ANTHROPIC_API_KEY nenÃ­ nastaven"
        },
        {
          "type": "card",
          "variant": "danger",
          "title": "Å˜eÅ¡enÃ­",
          "code": "export ANTHROPIC_API_KEY=\"sk-ant-...\"\n# nebo uloÅ¾ do ~/.anthropic-api-key\necho \"sk-ant-...\" > ~/.anthropic-api-key"
        },
        {
          "type": "heading",
          "text": "Chyba: Ollama nenÃ­ dostupnÃ½"
        },
        {
          "type": "card",
          "variant": "danger",
          "title": "Å˜eÅ¡enÃ­",
          "code": "# SpusÅ¥ daemon\nollama serve\n\n# Test\ncurl -s http://localhost:11434/api/tags"
        },
        {
          "type": "heading",
          "text": "Chyba: Database je locked"
        },
        {
          "type": "card",
          "variant": "warning",
          "title": "Å˜eÅ¡enÃ­",
          "text": "SQLite lock se mÅ¯Å¾e stÃ¡t, pokud bÄ›Å¾Ã­ vÃ­ce procesÅ¯. Zkus:",
          "code": "# Odstran lock\nrm ~/.ai-agent/tokens.db-wal\nrm ~/.ai-agent/tokens.db-shm\n\n# Zkus znovu\nagent billing"
        },
        {
          "type": "heading",
          "text": "Chyba: JSON schÃ©ma se nevaliduje"
        },
        {
          "type": "card",
          "variant": "warning",
          "title": "Å˜eÅ¡enÃ­",
          "code": "# Zkontroluj JSON\npython build.py --project ai --check\n\n# Oprav dle hlÃ¡Å¡ek schÃ©ma\n# NejÄastÄ›ji: 'entries' mÃ­sto 'items', chybÄ›jÃ­cÃ­ povinnÃ¡ pole"
        }
      ]
    }
  ]
}