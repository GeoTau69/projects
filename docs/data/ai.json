{
  "project": "ai",
  "display_name": "AI Dev Agent Stack",
  "version": "1.2.0",
  "updated": "2026-02-22",
  "description": "Plugin-based AI orchestrator se s√©mantickou cache. Komplexn√≠ sada n√°stroj≈Ø: token tracking, prompt cache, s√©mantick√© vyhled√°v√°n√≠ k√≥du, model routing (Ollama ‚Üî Claude), persistence pamƒõti a dokumentaƒçn√≠ pipeline.",
  "status": "active",
  "port": null,
  "tech": ["python", "sqlite", "numpy", "ollama", "anthropic-api", "markdown"],
  "access": {
    "local": "http://localhost:8080?project=ai",
    "lan": "http://192.168.0.101:8080?project=ai"
  },
  "modules": [
    {
      "id": "orchestrator",
      "name": "Plugin Orchestrator",
      "file": "_meta/orchestrator.py",
      "purpose": "Centr√°ln√≠ middleware: semantic cache lookup ‚Üí hash cache ‚Üí backend routing ‚Üí execute ‚Üí billing ‚Üí cache store",
      "status": "stable",
      "public_methods": [
        {
          "name": "agent ask",
          "params": "\"prompt\" --operation OP --project X [--model auto] [--system TEXT]",
          "returns": "str (odpovƒõƒè)",
          "description": "CLI entry point ‚Äî vol√° Orchestrator.request() se Spinner UI"
        },
        {
          "name": "Orchestrator.request()",
          "params": "messages, operation, project, model='auto', system=None, max_tokens=4096",
          "returns": "Response(text, tokens_in, tokens_out, model, cost)",
          "description": "Core method: 7-step pipeline (semantic cache ‚Üí hash cache ‚Üí routing ‚Üí execute ‚Üí log ‚Üí cache)"
        }
      ],
      "dependencies": ["plugins/base, plugins/claude, plugins/ollama, billing, router, semantic_cache"],
      "notes": "Fallback routing: kdy≈æ Claude API nedostupn√Ω ‚Üí automaticky Ollama/qwen2.5-coder:14b"
    },
    {
      "id": "token_tracker",
      "name": "Token Tracker",
      "file": "_meta/token_tracker.py",
      "purpose": "SQLite √∫ƒçetnictv√≠ API vol√°n√≠ + prompt cache + model routing",
      "status": "stable",
      "public_methods": [
        {
          "name": "call_api",
          "params": "project: str, operation: str, model: str = 'auto', messages: list, system: str = ''",
          "returns": "str",
          "description": "Zpƒõtnƒõ kompatibiln√≠ wrapper na Orchestrator.request()"
        },
        {
          "name": "agent log",
          "params": "--project X --operation op --model sonnet --in 5000 --out 1200",
          "returns": "None",
          "description": "Ruƒçn√≠ z√°znam API vol√°n√≠ pro Claude Code sessions"
        },
        {
          "name": "agent billing",
          "params": "--today|--week|--month|--top|--project X|--model M",
          "returns": "str (tabulka)",
          "description": "P≈ôehled n√°klad≈Ø na API vol√°n√≠"
        },
        {
          "name": "agent cache",
          "params": "--stats|--list|--clear|--clear --all",
          "returns": "str (v√Ωpis)",
          "description": "Spr√°va hash cache: statistiky, seznam, vymaz√°n√≠"
        },
        {
          "name": "agent route",
          "params": "--show|--test OPERACE",
          "returns": "str (tabulka)",
          "description": "Zobrazen√≠ a testov√°n√≠ model routing tabulky"
        }
      ],
      "dependencies": [],
      "notes": "Datab√°ze: ~/.ai-agent/tokens.db. CLI dostupn√© p≈ôes ~/bin/agent"
    },
    {
      "id": "chroma_indexer",
      "name": "S√©mantick√Ω vyhled√°vaƒç",
      "file": "_meta/chroma_indexer.py",
      "purpose": "Indexov√°n√≠ a vyhled√°v√°n√≠ k√≥du pomoc√≠ vektorov√Ωch embedding≈Ø (nomic-embed-text p≈ôes Ollama)",
      "status": "stable",
      "public_methods": [
        {
          "name": "agent index",
          "params": "[--project NAME|--diff|--force|--docs]",
          "returns": "None",
          "description": "Indexov√°n√≠ workspace ƒçi jednoho projektu"
        },
        {
          "name": "agent search",
          "params": "\"dotaz\" [--project X|--top N|--scope docs]",
          "returns": "list[SearchResult]",
          "description": "S√©mantick√© vyhled√°v√°n√≠ k√≥du a dokumentace"
        }
      ],
      "dependencies": ["token_tracker (pro Ollama API)"],
      "notes": "Datab√°ze: ~/.ai-agent/code_index.db. Kompatibiln√≠ s Python 3.14 (alternativa k chromadb)"
    },
    {
      "id": "semantic_cache",
      "name": "Semantic Cache",
      "file": "_meta/semantic_cache.py",
      "purpose": "Embedding-based cache ‚Äî nomic-embed-text embeddingy, cosine similarity lookup",
      "status": "stable",
      "public_methods": [
        {
          "name": "embed(text)",
          "params": "text: str",
          "returns": "np.ndarray | None",
          "description": "Vol√° Ollama nomic-embed-text, vr√°t√≠ embedding"
        },
        {
          "name": "lookup(prompt, operation, threshold=0.90)",
          "params": "prompt: str, operation: str, threshold: float",
          "returns": "str | None",
          "description": "Hled√° s√©manticky podobnou cached odpovƒõƒè, vr√°t√≠ response pokud cosine_similarity >= threshold"
        },
        {
          "name": "store(prompt, response, operation, model)",
          "params": "prompt: str, response: str, operation: str, model: str",
          "returns": "None",
          "description": "Ulo≈æ√≠ embedding + text do cache_embeddings tabulky"
        }
      ],
      "dependencies": ["ollama (nomic-embed-text)"],
      "notes": "Fallback na hash cache pokud Ollama nedostupn√°. DB tabulka: cache_embeddings v ~/.ai-agent/tokens.db"
    },
    {
      "id": "docs_pipeline",
      "name": "Docs Pipeline",
      "file": "docs/build.py",
      "purpose": "JSON ‚Üí HTML renderer (Jinja2). AI generuje JSON, build.py renderuje statick√© HTML bez √∫ƒçasti AI",
      "status": "stable",
      "public_methods": [
        {
          "name": "build.py",
          "params": "[--project NAME|--check|--force|--output FILE]",
          "returns": "HTML file",
          "description": "Transformace docs/data/{projekt}.json ‚Üí docs/output/{projekt}.html"
        }
      ],
      "dependencies": ["jinja2"],
      "notes": "Kl√≠ƒçov√© pravidlo: seznam polo≈æek se zapisuje jako 'entries' (ne 'items' ‚Äî Jinja2 conflict). Sch√©ma: docs/schema/doc_schema.json"
    },
    {
      "id": "persistence_system",
      "name": "Persistence pamƒõti",
      "file": "memory/MEMORY.md + memory/session.md + CLAUDE.md",
      "purpose": "Cross-model persistentn√≠ session syst√©m. Zachov√°v√° kontext nap≈ô√≠ƒç seseionami a model≈Ø (Haiku ‚Üî Sonnet ‚Üî Opus)",
      "status": "stable",
      "public_methods": [
        {
          "name": "konec zvonec",
          "params": "N/A ‚Äî sign√°ln√≠ fr√°ze",
          "returns": "Tich√© ulo≈æen√≠ stavu",
          "description": "Trigger pro ulo≈æen√≠ MEMORY.md + MODEL.md SESSION LOG + git commit+push"
        },
        {
          "name": "≈°tafeta",
          "params": "N/A ‚Äî sign√°ln√≠ fr√°ze",
          "returns": "Aktualizace MEMORY.md",
          "description": "Lehk√Ω handoff mezi modely ‚Äî bez git, bez sanitace"
        }
      ],
      "dependencies": [],
      "notes": "Auto-memory cesta: ~/.claude/projects/{hash}/memory/. MEMORY.md max 200 ≈ô√°dk≈Ø, auto-loaded."
    }
  ],
  "sections": [
    {
      "id": "prehled",
      "title": "P≈ôehled",
      "icon": "üìã",
      "blocks": [
        {
          "type": "text",
          "text": "AI Dev Agent Stack je integrovan√Ω syst√©m pro pr√°ci s AI. Zahrnuje plugin-based orchestr√°tor, token tracking, s√©mantickou cache, routing mezi Ollama (local) a Claude API (cloud), a persistentn√≠ session pamƒõ≈•."
        },
        {
          "type": "heading",
          "text": "Kl√≠ƒçov√© funkce"
        },
        {
          "type": "list",
          "entries": [
            "Plugin orchestr√°tor s fallback routingem ‚Äî Claude ‚Üí Ollama",
            "S√©mantick√° cache (nomic-embed-text embeddingy + cosine similarity)",
            "Hash cache s TTL pravidly per operaci",
            "Transparentn√≠ token tracking a billing",
            "S√©mantick√© vyhled√°v√°n√≠ k√≥du (SQLite + numpy)",
            "Cross-model persistence ‚Äî kontext zachov√°n mezi seseionami",
            "CLI + Python API"
          ]
        },
        {
          "type": "heading",
          "text": "Status implementace (2026-02-22)"
        },
        {
          "type": "table",
          "headers": ["Modul", "Status", "Soubor"],
          "rows": [
            ["Token √∫ƒçetnictv√≠", "‚úÖ HOTOVO", "_meta/token_tracker.py"],
            ["Prompt cache / deduplication", "‚úÖ HOTOVO", "_meta/token_tracker.py"],
            ["S√©mantick√Ω vyhled√°vaƒç k√≥du", "‚úÖ HOTOVO", "_meta/chroma_indexer.py"],
            ["Model routing", "‚úÖ HOTOVO", "_meta/token_tracker.py"],
            ["Plugin orchestrator", "‚úÖ HOTOVO", "_meta/orchestrator.py + plugins/"],
            ["Semantic cache", "‚úÖ HOTOVO", "_meta/semantic_cache.py"],
            ["Docs pipeline (JSON/Jinja2)", "‚úÖ HOTOVO", "docs/build.py"],
            ["Persistence pamƒõti", "‚úÖ HOTOVO", "memory/MEMORY.md + Golden Rules"]
          ]
        }
      ]
    },
    {
      "id": "architektura",
      "title": "Architektura",
      "icon": "üèóÔ∏è",
      "blocks": [
        {
          "type": "heading",
          "text": "Komponenty"
        },
        {
          "type": "code",
          "lang": "text",
          "text": "~/bin/agent  (router)\n    ‚îú‚îÄ‚îÄ log / billing / cache / route / ask / init  ‚Üí  _meta/token_tracker.py\n    ‚îî‚îÄ‚îÄ index / search                              ‚Üí  _meta/chroma_indexer.py\n\nOrchestrator pipeline:\n    1. Semantic cache lookup (nomic-embed-text)\n    2. Hash cache lookup (SHA-256, TTL-aware)\n    3. Backend routing (dle ROUTING_RULES)\n    4. Execute (Claude API / Ollama HTTP)\n    5. Log billing (SQLite)\n    6. Cache store (semantic + hash)\n\nDatab√°ze: ~/.ai-agent/\n    ‚îú‚îÄ‚îÄ tokens.db       ‚Äî token log + hash cache + cache_embeddings\n    ‚îî‚îÄ‚îÄ code_index.db   ‚Äî k√≥dov√© chunky + numpy embeddingy\n\nOllama (localhost:11434):\n    ‚îú‚îÄ‚îÄ nomic-embed-text:latest   ‚Äî embeddingy pro semantic cache\n    ‚îú‚îÄ‚îÄ qwen2.5-coder:14b         ‚Äî LOCAL_MODEL (doc_update, boilerplate, info_sync)\n    ‚îî‚îÄ‚îÄ deepseek-coder:33b        ‚Äî dostupn√Ω, nenakonfigurov√°n v routeru\n\nPersistence: ~/.claude/projects/{hash}/memory/\n    ‚îú‚îÄ‚îÄ MEMORY.md       ‚Äî auto-loaded session state\n    ‚îî‚îÄ‚îÄ {hash}/         ‚Äî per-project memory"
        }
      ]
    },
    {
      "id": "ollama",
      "title": "Ollama ‚Äî instalace a modely",
      "icon": "ü¶ô",
      "blocks": [
        {
          "type": "text",
          "text": "Bƒõ≈æ√≠ na <code>http://localhost:11434</code>. Orchestr√°tor automaticky detekuje dostupnost p≈ôes HTTP HEAD request."
        },
        {
          "type": "heading",
          "text": "Dostupn√© modely"
        },
        {
          "type": "table",
          "headers": ["Model", "Velikost", "Pou≈æit√≠", "Status"],
          "rows": [
            ["nomic-embed-text:latest", "274 MB", "Embeddingy (semantic_cache, chroma_indexer)", "‚úÖ aktivn√≠"],
            ["qwen2.5-coder:14b", "9.0 GB", "LOCAL_MODEL ‚Äî doc_update, boilerplate, info_sync", "‚úÖ aktivn√≠"],
            ["deepseek-coder:33b", "18 GB", "Dostupn√Ω, nenakonfigurov√°n v ROUTING_RULES", "‚ö™ rezerva"]
          ]
        },
        {
          "type": "text",
          "text": "Zmƒõna aktivn√≠ho lok√°ln√≠ho modelu: upravit <code>LOCAL_MODEL</code> v <code>_meta/router.py</code>."
        }
      ]
    },
    {
      "id": "golden_rules",
      "title": "Golden Rules ‚Äî Session persistence",
      "icon": "üìú",
      "blocks": [
        {
          "type": "text",
          "text": "Detailn√≠ guide v <code>/home/geo/projects/CLAUDE.md</code>. Zde shrnut√≠ kl√≠ƒçov√Ωch pravidel."
        },
        {
          "type": "heading",
          "text": "Sign√°ln√≠ fr√°ze"
        },
        {
          "type": "table",
          "headers": ["Fr√°ze", "Kdy", "Co agent udƒõl√°"],
          "rows": [
            ["<strong>≈°tafeta</strong>", "P≈ôed√°n√≠ jin√©mu modelu (p≈ôed /model)", "Aktualizuje oba MEMORY.md se shrnut√≠m + specifikac√≠. Bez git, bez sanitace."],
            ["<strong>konec zvonec</strong>", "Konec pr√°ce, odhl√°≈°en√≠", "Sanitace + oba MEMORY.md + MODEL.md session log + git commit + push"]
          ]
        },
        {
          "type": "heading",
          "text": "Pravidlo 1: Dual MEMORY.md (synchronizace)"
        },
        {
          "type": "text",
          "text": "Auto-load cesty dle CWD:<br/>‚Ä¢ Start z <code>/home/geo/projects/</code> ‚Üí <code>~/.claude/projects/-home-geo-projects/memory/MEMORY.md</code><br/>‚Ä¢ Start z <code>/home/geo/</code> ‚Üí <code>~/.claude/projects/-home-geo/memory/MEMORY.md</code><br/><br/>P≈ôi ≈°tafetƒõ/konec zvonec: aktualizovat OBOU aby se kontext neztratil mezi session/modely."
        },
        {
          "type": "heading",
          "text": "Pravidlo 2: Model routing (3 role)"
        },
        {
          "type": "table",
          "headers": ["Model", "Role", "Odpovƒõdnost", "Kdy"],
          "rows": [
            ["Opus 4.6", "Architekt", "N√°vrh, audit, slo≈æit√© probl√©my, specifikace", "Architektonick√° rozhodnut√≠"],
            ["Sonnet 4.6", "SW in≈æen√Ωr", "Implementace + vlastn√≠k v≈°ech {projekt}/CLAUDE.md", "Ve≈°ker√Ω k√≥d + aktualizace kontextu"],
            ["Haiku 4.5", "Dokumentarista", "POUZE docs/data/{projekt}.json ‚Üí HTML pipeline", "ƒåte CLAUDE.md, negeneruje ho"]
          ]
        },
        {
          "type": "text",
          "text": "<strong>Pravidlo vlastnictv√≠ CLAUDE.md:</strong><br/>‚Ä¢ <code>{projekt}/CLAUDE.md</code> = v√Ωhradnƒõ Sonnet ‚Äî p√≠≈°e, aktualizuje, refaktoruje<br/>‚Ä¢ Haiku sm√≠ CLAUDE.md <strong>ƒç√≠st</strong>, ale <strong>NESM√ç ho modifikovat</strong><br/>‚Ä¢ V√Ωjimka: <code>memory/MEMORY.md</code> p≈ôi ≈°tafetƒõ/konec zvonec ‚Äî v≈°echny modely"
        },
        {
          "type": "heading",
          "text": "Pravidlo 3: Output struƒçnost ‚Äî POVINN√â"
        },
        {
          "type": "text",
          "text": "Maxim√°ln√≠ priorita: minimalizovat output tokeny (u≈æivatel plat√≠).<br/><br/>‚Ä¢ <strong>Mezi tool cally:</strong> ≈Ω√°dn√Ω koment√°≈ô pokud nen√≠ architektonick√© rozhodnut√≠<br/>‚Ä¢ <strong>Na zaƒç√°tku:</strong> Max 3 bullet points co se zmƒõn√≠<br/>‚Ä¢ <strong>Na konci:</strong> Max 3 bullet points co se zmƒõnilo<br/>‚Ä¢ <strong>Vynechat:</strong> \"teƒè udƒõl√°m X\", debug output, mechanick√Ω pr≈Øbƒõh"
        }
      ]
    },
    {
      "id": "token_tracker",
      "title": "Token Tracker",
      "icon": "üí∞",
      "blocks": [
        {
          "type": "text",
          "text": "SQLite √∫ƒçetnictv√≠ v≈°ech API vol√°n√≠ + prompt cache + model routing. Centr√°ln√≠ bod pro kontrolu n√°klad≈Ø na AI pr√°ci."
        },
        {
          "type": "heading",
          "text": "CLI p≈ô√≠kazy"
        },
        {
          "type": "code",
          "lang": "bash",
          "text": "# Manu√°ln√≠ z√°znam (pro Claude Code sessions)\nagent log --project X --operation doc_update --model sonnet --in 5000 --out 1200 [--notes \"...\"]\n\n# P≈ôehledy\nagent billing                    # v≈°e\nagent billing --today            # jen dnes\nagent billing --week             # posledn√≠ch 7 dn√≠\nagent billing --month            # posledn√≠ch 30 dn√≠\nagent billing --project X        # filtr projektu\nagent billing --model sonnet     # filtr modelu\nagent billing --top              # top operace dle ceny\n\n# Prompt cache\nagent cache --stats              # statistiky + TTL pravidla\nagent cache --list               # seznam ulo≈æen√Ωch odpovƒõd√≠\nagent cache --clear              # smazat expirovan√©\nagent cache --clear --all        # smazat v≈°e\n\n# Model routing\nagent route --show               # zobrazit routing tabulku\nagent route --test doc_update    # otestovat routing pro operaci\n\n# Init\nagent init                       # inicializovat ~/.ai-agent/ a DB"
        },
        {
          "type": "heading",
          "text": "Model routing tabulka"
        },
        {
          "type": "table",
          "headers": ["Operace", "C√≠l", "Model"],
          "rows": [
            ["doc_update", "local", "qwen2.5-coder:14b"],
            ["boilerplate", "local", "qwen2.5-coder:14b"],
            ["info_sync", "local", "qwen2.5-coder:14b"],
            ["code_review", "cloud", "claude-sonnet-4-6"],
            ["architecture", "cloud", "claude-opus-4-6"],
            ["debug_complex", "cloud", "claude-sonnet-4-6"],
            ["_default", "cloud", "claude-sonnet-4-6"]
          ]
        },
        {
          "type": "heading",
          "text": "Ceny model≈Ø"
        },
        {
          "type": "table",
          "headers": ["Model", "Input", "Output"],
          "rows": [
            ["claude-opus-4-6", "$15/M", "$75/M"],
            ["claude-sonnet-4-6", "$3/M", "$15/M"],
            ["claude-haiku-4-5", "$0.80/M", "$4/M"],
            ["Ollama (lok√°ln√≠)", "$0", "$0"]
          ]
        }
      ]
    },
    {
      "id": "orchestrator",
      "title": "Orchestrator ‚Äî Plugin middleware",
      "icon": "üé≠",
      "blocks": [
        {
          "type": "text",
          "text": "Plugin-based AI middleware s centr√°ln√≠m cache a billing. Nahrazuje monolitick√Ω token_tracker.py star√© verze. Nov√Ω design: registry backendu, routing, modul√°rn√≠ cache."
        },
        {
          "type": "heading",
          "text": "7-step pipeline"
        },
        {
          "type": "list",
          "ordered": true,
          "entries": [
            "Semantic cache lookup (nomic-embed-text embeddingy, cosine similarity)",
            "Hash cache lookup (SHA-256, TTL-aware dle operace)",
            "Router: select_backend() ‚Äî vybere dostupn√Ω backend dle ROUTING_RULES",
            "Execute: backend.execute() ‚Äî zavol√° Claude API nebo Ollama",
            "Log billing ‚Äî zaznamenn√° do SQLite tokens, cenu",
            "Cache store ‚Äî ulo≈æ√≠ do semantic_cache i hash_cache",
            "Return Response ‚Äî vr√°t√≠ text, tokens, cenu, model"
          ]
        },
        {
          "type": "heading",
          "text": "CLI"
        },
        {
          "type": "code",
          "lang": "bash",
          "text": "agent ask \"prompt\" --operation code_review --project X [--model auto]\nagent ask \"ahoj\" --model sonnet --project cli\n\n# Zobrazuje spinner bƒõhem vol√°n√≠: ‚†ã Zpracov√°v√°m... [claude-sonnet-4-6]"
        },
        {
          "type": "heading",
          "text": "Moduly (v _meta/)"
        },
        {
          "type": "table",
          "headers": ["Modul", "Role"],
          "rows": [
            ["plugins/base.py", "Backend ABC + Response dataclass"],
            ["plugins/claude.py", "Anthropic API (is_available checks ANTHROPIC_API_KEY)"],
            ["plugins/ollama.py", "Ollama HTTP (is_available checks localhost:11434)"],
            ["billing.py", "DB, ceny, hash cache funcs"],
            ["router.py", "ROUTING_RULES, select_backend(), CACHE_TTL"],
            ["semantic_cache.py", "nomic-embed-text embeddingy, cosine similarity lookup"],
            ["orchestrator.py", "Orchestrator class ‚Äî core"]
          ]
        },
        {
          "type": "heading",
          "text": "Python API"
        },
        {
          "type": "code",
          "lang": "python",
          "text": "from _meta.orchestrator import Orchestrator\nfrom _meta.plugins.claude import ClaudeBackend\nfrom _meta.plugins.ollama import OllamaBackend\n\norch = Orchestrator()\norch.register(ClaudeBackend())\norch.register(OllamaBackend())\n\nresp = orch.request(\n    messages   = [{'role': 'user', 'content': '...'}],\n    operation  = 'code_review',\n    project    = 'backup-dashboard',\n    model      = 'auto',  # ‚Üí routing tabulka\n    system     = '...',   # voliteln√©\n    max_tokens = 4096,\n)\nprint(resp.text)\nprint(f\"Cost: ${resp.cost:.4f}\")"
        }
      ]
    },
    {
      "id": "semantic_search",
      "title": "S√©mantick√© vyhled√°v√°n√≠",
      "icon": "üîç",
      "blocks": [
        {
          "type": "text",
          "text": "Indexov√°n√≠ a vyhled√°v√°n√≠ k√≥du pomoc√≠ vektorov√Ωch embedding≈Ø. Stack: SQLite + numpy + nomic-embed-text p≈ôes Ollama HTTP. Kompatibiln√≠ s Python 3.14 (alternativa k chromadb)."
        },
        {
          "type": "heading",
          "text": "CLI p≈ô√≠kazy"
        },
        {
          "type": "code",
          "lang": "bash",
          "text": "# Indexov√°n√≠\nagent index                          # cel√Ω workspace (mtime cache)\nagent index --project dashboard      # jen jeden projekt\nagent index --diff                   # jen git-changed soubory (git diff HEAD)\nagent index --force                  # ignoruj mtime, p≈ôeindexuj v≈°e\nagent index --docs                   # indexuj i .md soubory\n\n# Vyhled√°v√°n√≠\nagent search \"retry logika\"\nagent search \"z√°loha borg archiv\" --project backup-dashboard\nagent search \"WebSocket rooms\"  --top 10\nagent search \"co projekt dƒõl√°\" --scope docs    # hled√° v .md souborech"
        },
        {
          "type": "heading",
          "text": "Chunking strategie"
        },
        {
          "type": "table",
          "headers": ["Typ souboru", "Strategie", "Chunk ="],
          "rows": [
            [".py", "Per definice", "jedna 'def' nebo 'class'"],
            [".md", "Per sekce", "jeden '#' nebo '##' nadpis"],
            ["ostatn√≠", "Sliding window", "60 ≈ô√°dk≈Ø, 10 overlap"]
          ]
        }
      ]
    },
    {
      "id": "docs_pipeline",
      "title": "Docs pipeline",
      "icon": "üìÑ",
      "blocks": [
        {
          "type": "text",
          "text": "AI generuje <code>docs/data/{projekt}.json</code> (data-only), <code>build.py</code> renderuje HTML p≈ôes Jinja2 (bez AI). T√≠m se dramaticky sni≈æuj√≠ n√°klady ‚Äî AI nemus√≠ generovat HTML."
        },
        {
          "type": "heading",
          "text": "P≈ô√≠kazy"
        },
        {
          "type": "code",
          "lang": "bash",
          "text": "python3 docs/build.py                              # v≈°echny projekty\npython3 docs/build.py --project backup-dashboard   # jen jeden\npython3 docs/build.py --check                      # jen validace JSON\npython3 docs/build.py --force                      # ignoruj hash cache\npython3 docs/build.py --output /cesta/soubor.html  # vlastn√≠ v√Ωstup"
        },
        {
          "type": "card",
          "variant": "info",
          "title": "Kl√≠ƒçov√© pravidlo",
          "text": "Pole pro seznam polo≈æek v JSON bloc√≠ch se naz√Ωv√° <code>'entries'</code> (nikoli 'items' ‚Äî items je Pythonova dict metoda a Jinja2 ji zachyt√≠ d≈ô√≠ve ne≈æ dict kl√≠ƒç)."
        }
      ]
    },
    {
      "id": "persistence",
      "title": "Persistence pamƒõti",
      "icon": "üíæ",
      "blocks": [
        {
          "type": "text",
          "text": "T≈ô√≠vrstv√Ω syst√©m zachov√°vaj√≠c√≠ kontext nap≈ô√≠ƒç seseionami a model≈Ø. ≈òe≈°en√≠ probl√©mu ztr√°ty kontextu po odhl√°≈°en√≠ z Claude Code."
        },
        {
          "type": "heading",
          "text": "Jak funguje"
        },
        {
          "type": "text",
          "text": "Jsou 3 vrstvy: (1) <code>CLAUDE.md</code> ‚Äî master pravidla s Golden Rule (versioned v git), (2) <code>memory/</code> adres√°≈ô ‚Äî volatile session state auto-naƒç√≠tan√Ω Claudem, (3) <code>MODEL.md</code> ‚Äî handoff dokument pro AI (versioned v git)."
        },
        {
          "type": "heading",
          "text": "Sign√°ln√≠ fr√°ze: 'konec zvonec'"
        },
        {
          "type": "text",
          "text": "Kdy≈æ u≈æivatel nap√≠≈°e <code>konec zvonec</code>, jak√Ωkoliv model (Haiku/Sonnet/Opus) ti≈°e:"
        },
        {
          "type": "list",
          "ordered": true,
          "entries": [
            "Aktualizuje ~/.claude/projects/*/memory/MEMORY.md (aktu√°ln√≠ √∫kol + posledn√≠ akce + next steps)",
            "P≈ôid√° z√°znam do MODEL.md SESSION LOG",
            "Commitne + pushne: git add MODEL.md && git commit && git push gitea main && git push github main",
            "Nap√≠≈°e: 'V≈°e synchronizov√°no ‚Äî m≈Ø≈æe≈° se odhl√°sit.'"
          ]
        },
        {
          "type": "heading",
          "text": "P≈ô√≠≈°t√≠ session"
        },
        {
          "type": "text",
          "text": "Nov√Ω model (jak√Ωkoliv) se p≈ôihl√°s√≠ ‚Üí Claude Code auto-naƒçte MEMORY.md ‚Üí model vid√≠ co se dƒõlalo ‚Üí pokraƒçuje bez ztr√°t."
        },
        {
          "type": "heading",
          "text": "Soubory a jejich role"
        },
        {
          "type": "table",
          "headers": ["Soubor", "Um√≠stƒõn√≠", "Role", "Kdo p√≠≈°e"],
          "rows": [
            ["CLAUDE.md", "/home/geo/projects/", "Master pravidla + golden rule", "Developer + AI"],
            ["MEMORY.md", "~/.claude/projects/.../memory/", "Volatile session state", "Jak√Ωkoliv model"],
            ["MODEL.md", "/home/geo/projects/", "AI handoff + architektura", "Jak√Ωkoliv model"]
          ]
        }
      ]
    }
  ]
}
